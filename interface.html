<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Hands to Heaven â€” Shop</title>
    <meta name="description" content="Hands to Heaven official store. Explore curated collections with a serene, modern experience." />
    <meta name="color-scheme" content="light dark" />

    <style>
      :root {
        --bg: #ffffff;               /* white */
        --fg: #1a1a1a;               /* near-black text */
        --muted: #6b7280;            /* gray-500 */
        --border: #f1f5f9;           /* light border */
        --brand: #f59e0b;            /* amber-500 */
        --brand-600: #d97706;        /* amber-600 */
        --accent: #fff7ed;           /* orange-50 */
        --card: #ffffff;             /* white cards */
        --success: #10b981;          /* green-500 */
        --warning: #f59e0b;          /* amber-500 */
        --error: #ef4444;            /* red-500 */
        --shadow: 0 1px 2px rgba(0,0,0,0.06), 0 4px 16px rgba(0,0,0,0.06);
      }
      @media (prefers-color-scheme: dark) {
        :root {
          /* Keep light pink theme even in dark-mode preference */
          --bg: #ffffff;
          --fg: #1a1a1a;
          --muted: #6b7280;
          --border: #f1f5f9;
          --brand: #f59e0b;
          --brand-600: #d97706;
          --accent: #fff7ed;
          --card: #ffffff;
          --shadow: 0 1px 2px rgba(0,0,0,0.06), 0 6px 24px rgba(0,0,0,0.08);
        }
      }

      html, body { height: 100%; }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        background: var(--bg);
        color: var(--fg);
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        overflow-x: hidden;
      }
      a { color: inherit; text-decoration: none; }
      img { max-width: 100%; display: block; }
      button { font: inherit; color: inherit; }
      input, select { font: inherit; color: inherit; }

      .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
      .visually-hidden { position: absolute; left: -9999px; width: 1px; height: 1px; overflow: hidden; }

      /* Top notice */
      .notice {
        background: linear-gradient(90deg, var(--brand), var(--brand-600));
        color: white;
        font-weight: 600;
        text-align: center;
        padding: 8px 12px;
        font-size: 14px;
      }

      /* Header */
      header {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        z-index: 300;
        background: var(--bg);
        border-bottom: 1px solid var(--border);
        backdrop-filter: saturate(180%) blur(8px);
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      }
      main {
        margin-top: 60px;
      }
      .header-inner {
        display: grid;
        grid-template-columns: auto 1fr auto;
        align-items: center;
        gap: 16px;
        padding: 14px 0;
      }
      .brand-spacer { height: 36px; }
      .brand {
        display: flex;
        align-items: center;
        gap: 10px;
        font-weight: 800;
        letter-spacing: 0.2px;
        margin-left: 12px;
      }
      .header-search-icon {
        display: none; /* Hidden on desktop by default */
      }
      .brand-logo {
        width: 36px; height: 36px; border-radius: 10px;
        object-fit: cover;
        box-shadow: var(--shadow);
      }
      .brand-name { 
        font-size: 18px; 
        text-transform: uppercase; 
        display: none; /* Hidden on desktop header, shown on mobile */
      }
      /* Larger brand in hero only */
      .hero .brand-logo { width: 140px; height: 140px; border-radius: 20px; }
      .hero .brand-name { 
        font-size: 44px; 
        letter-spacing: 0.6px; 
        display: block; /* Always visible in hero */
      }

      .search {
        display: flex; align-items: center; gap: 10px;
        background: var(--card);
        border: 1px solid var(--border);
        border-radius: 9999px; padding: 10px 14px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.04);
        position: relative;
        overflow: visible;
        transition: box-shadow .2s ease, transform .1s ease, border-color .2s ease;
        width: 100%;
        min-width: 0; /* allow grid item to shrink without overlapping */
        max-width: 520px;
        justify-self: center;
      }
      .search input {
        flex: 1; border: 0; outline: 0; background: transparent;
      }
      /* Hide native clear (X) so we only show our custom clear button */
      .search input::-webkit-search-cancel-button { -webkit-appearance: none; appearance: none; height: 0; width: 0; display: none; }
      .search input::-webkit-search-decoration { -webkit-appearance: none; }
      .search input::-ms-clear { display: none; width: 0; height: 0; }
      .search button[type="submit"] {
        border: 0; background: var(--brand); color: #fff;
        padding: 10px 14px; border-radius: 9999px; cursor: pointer;
      }
      .search:focus-within {
        border-color: var(--brand);
        box-shadow: 0 6px 22px rgba(245,158,11,0.18), 0 0 0 2px rgba(245,158,11,0.25);
        transform: translateY(-1px);
      }
      .clear-btn { background: none; border: none; padding: 6px; cursor: pointer; color: var(--muted); border-radius: 8px; }
      .clear-btn:hover { background: var(--accent); color: var(--fg); }

      /* Search dropdown */
      .search-dropdown { position: absolute; top: calc(100% + 8px); left: 0; right: 0; background: var(--card); border: 1px solid var(--border); border-radius: 12px; box-shadow: var(--shadow); display: none; overflow: hidden; z-index: 90; }
      .search.open .search-dropdown { display: block; }
      .search-list { max-height: 320px; overflow: auto; padding: 6px; display: grid; gap: 6px; }
      .search-item { display: grid; grid-template-columns: 44px 1fr auto; gap: 10px; align-items: center; padding: 8px; border-radius: 10px; cursor: pointer; border: 1px solid transparent; }
      .search-item:hover, .search-item[aria-selected="true"] { background: var(--accent); border-color: var(--border); }
      .search-thumb { width: 44px; height: 44px; border-radius: 10px; object-fit: cover; box-shadow: var(--shadow); }
      .search-title { font-weight: 700; }
      .search-sub { color: var(--muted); font-size: 12px; }
      .search-price { font-weight: 700; }

      .highlight { outline: 2px solid var(--brand); outline-offset: 2px; border-radius: 12px; }

      nav.primary {
        display: flex; gap: 12px; justify-content: flex-end; align-items: center; flex-wrap: nowrap; flex: 0 0 auto;
      }
      .link-btn, .icon-btn { flex-shrink: 0; }
      .nav-link { padding: 8px 10px; color: var(--muted); }
      .nav-link:hover { color: var(--fg); }
      .icon-btn { background: none; border: 1px solid var(--border); border-radius: 10px; padding: 8px; cursor: pointer; display: inline-flex; align-items: center; gap: 8px; }
      .cart-count { background: var(--brand); color: #fff; border-radius: 999px; padding: 2px 8px; font-size: 12px; font-weight: 700; }
      .hamburger { display: none; }
      .link-btn { background: var(--card); border: 1px solid var(--border); border-radius: 10px; padding: 8px 12px; display: inline-flex; align-items: center; gap: 8px; cursor: pointer; box-shadow: var(--shadow); }
      .link-btn:hover { background: var(--accent); }

      /* Dropdown */
      .dropdown { position: relative; }
      .dropdown-menu {
        position: absolute; right: 0; top: calc(100% + 8px);
        background: var(--card);
        border: 1px solid var(--border);
        border-radius: 12px;
        min-width: 180px;
        box-shadow: var(--shadow);
        padding: 8px;
        display: none;
        z-index: 80;
      }
      .dropdown[data-open="true"] .dropdown-menu { display: block; }
      .menu-item { display: flex; align-items: center; gap: 10px; padding: 10px 12px; border-radius: 10px; color: var(--fg); }
      .menu-item:hover { background: var(--accent); }

      /* Phone preview modal */
      .phone-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.55); backdrop-filter: blur(2px); display: none; place-items: center; z-index: 120; }
      .phone-overlay[aria-hidden="false"] { display: grid; }
      
      /* Chatbot styles */
      .chatbot-overlay {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.5);
        backdrop-filter: blur(4px);
        display: none;
        place-items: center;
        z-index: 150;
        padding: 20px;
      }
      .chatbot-overlay[aria-hidden="false"] {
        display: grid;
      }
      .chatbot-container {
        width: 100%;
        max-width: 500px;
        height: 80vh;
        max-height: 700px;
        background: var(--card);
        border-radius: 16px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }
      .chatbot-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 16px 20px;
        border-bottom: 1px solid var(--border);
        background: var(--card);
      }
      .chatbot-header-content {
        display: flex;
        align-items: center;
        gap: 10px;
      }
      .chatbot-header-content svg {
        color: var(--brand);
      }
      .chatbot-header h3 {
        margin: 0;
        font-size: 18px;
        font-weight: 700;
      }
      .chatbot-close {
        background: none;
        border: none;
        padding: 8px;
        cursor: pointer;
        color: var(--fg);
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .chatbot-close:hover {
        background: var(--accent);
      }
      .chatbot-messages {
        flex: 1;
        overflow-y: auto;
        padding: 20px;
        display: flex;
        flex-direction: column;
        gap: 16px;
      }
      .chatbot-message {
        display: flex;
        gap: 10px;
        animation: fadeIn 0.3s ease;
      }
      .chatbot-message.user {
        justify-content: flex-end;
      }
      .chatbot-message.bot {
        justify-content: flex-start;
      }
      .message-content {
        max-width: 75%;
        padding: 12px 16px;
        border-radius: 12px;
        background: var(--accent);
        border: 1px solid var(--border);
      }
      .chatbot-message.user .message-content {
        background: var(--brand);
        color: #fff;
        border-color: var(--brand);
      }
      .chatbot-message.bot .message-content {
        background: var(--accent);
        color: var(--fg);
      }
      .message-content p {
        margin: 0;
        line-height: 1.5;
        font-size: 14px;
      }
      .chatbot-input-container {
        display: flex;
        gap: 10px;
        padding: 16px 20px;
        border-top: 1px solid var(--border);
        background: var(--card);
      }
      .chatbot-input {
        flex: 1;
        padding: 12px 16px;
        border: 1px solid var(--border);
        border-radius: 12px;
        background: var(--bg);
        color: var(--fg);
        font-size: 14px;
        outline: none;
      }
      .chatbot-input:focus {
        border-color: var(--brand);
      }
      .chatbot-send {
        background: var(--brand);
        color: #fff;
        border: none;
        border-radius: 12px;
        padding: 12px 16px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: background 0.2s ease;
      }
      .chatbot-send:hover {
        background: var(--brand-600);
      }
      .chatbot-send:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      @media (max-width: 640px) {
        .chatbot-container {
          width: 100%;
          height: 100vh;
          max-height: 100vh;
          border-radius: 0;
        }
      }
      .phone-frame { width: 375px; height: 740px; background: #000; border-radius: 28px; box-shadow: 0 20px 60px rgba(0,0,0,0.5); border: 12px solid #111; position: relative; overflow: hidden; }
      .phone-notch { position: absolute; top: 0; left: 50%; transform: translateX(-50%); width: 140px; height: 24px; background: #111; border-bottom-left-radius: 14px; border-bottom-right-radius: 14px; z-index: 2; }
      .phone-iframe { position: absolute; inset: 0; border: 0; width: 100%; height: 100%; background: #000; }
      .phone-close { position: absolute; top: -48px; right: 0; background: #fff; color: #111; border: 0; border-radius: 10px; padding: 8px 10px; cursor: pointer; }

      /* Hero */
      .hero {
        background: linear-gradient(180deg, #ffffff, #fff7ed);
        border-bottom: 1px solid var(--border);
      }
      .hero-inner {
        display: grid; grid-template-columns: 1.2fr 0.8fr; gap: 40px; align-items: center; padding: 48px 0;
      }
      .hero h1 { font-size: 40px; line-height: 1.1; margin: 0 0 12px; }
      .hero p { color: var(--muted); margin: 0 0 20px; }
      .cta-row { display: flex; gap: 12px; align-items: center; }
      .btn {
        display: inline-flex; align-items: center; gap: 10px; border: 1px solid var(--border);
        padding: 12px 16px; border-radius: 12px; cursor: pointer; background: var(--card);
      }
      .btn.primary { background: var(--brand); color: white; border-color: transparent; }
      .btn.primary:hover { background: var(--brand-600); }
      .meta { display: flex; gap: 16px; color: var(--muted); font-size: 14px; margin-top: 12px; }

      .hero-media {
        border-radius: 16px; position: relative;
        background: none;
        box-shadow: var(--shadow);
        display: inline-block;
        width: fit-content;
        overflow: hidden;
        justify-self: start;
      }
      .hero-media::after {
        content: none;
        position: absolute; inset: 0; display: grid; place-items: center; color: #64748b;
        font-weight: 600; letter-spacing: 0.2px;
      }
      .hero-inline-logo { display: none; vertical-align: middle; border-radius: 8px; box-shadow: var(--shadow); }

      /* Layout */
      .layout { display: grid; grid-template-columns: 260px 1fr; gap: 24px; padding: 28px 0 40px; }

      /* Filters */
      .filters { background: var(--card); border: 1px solid var(--border); border-radius: 14px; padding: 16px; height: fit-content; box-shadow: var(--shadow); position: sticky; top: 82px; }
      .filters h3 { margin: 4px 0 12px; font-size: 16px; }
      .filter-group { border-top: 1px solid var(--border); padding-top: 12px; margin-top: 12px; }
      .checkbox { display: flex; align-items: center; gap: 10px; margin: 8px 0; }
      .price-row { display: flex; gap: 10px; }
      .price-row input { width: 100%; padding: 8px 10px; border: 1px solid var(--border); border-radius: 10px; background: transparent; }

      /* Product grid */
      .products-card { background: var(--card); border: 1px solid var(--border); border-radius: 14px; box-shadow: var(--shadow); }
      .toolbar { display: flex; justify-content: space-between; align-items: center; padding: 12px 16px; border-bottom: 1px solid var(--border); gap: 12px; flex-wrap: wrap; }
      .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; padding: 16px; }
      .card { border: 1px solid var(--border); border-radius: 12px; overflow: hidden; background: var(--bg); display: flex; flex-direction: column; position: relative; }
      .media { aspect-ratio: 1/1; background: linear-gradient(135deg, #ffedd5, #fff7ed); position: relative; }
      .media img { width: 100%; height: 100%; object-fit: cover; display: block; position: absolute; inset: 0; }
      .media::after { content: none; }
      .favorite-btn {
        position: absolute;
        top: 8px;
        right: 8px;
        background: rgba(255, 255, 255, 0.9);
        border: none;
        border-radius: 50%;
        width: 36px;
        height: 36px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        z-index: 10;
        transition: all 0.2s ease;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }
      .favorite-btn:hover {
        background: rgba(255, 255, 255, 1);
        transform: scale(1.1);
      }
      .favorite-btn.active {
        background: rgba(239, 68, 68, 0.1);
      }
      .favorite-btn svg {
        width: 20px;
        height: 20px;
        transition: all 0.2s ease;
      }
      .favorite-btn.active svg {
        fill: #ef4444;
        stroke: #ef4444;
      }
      .favorites-count {
        background: var(--brand);
        color: #fff;
        border-radius: 999px;
        padding: 2px 8px;
        font-size: 12px;
        font-weight: 700;
        position: absolute;
        top: -6px;
        right: -6px;
        display: none;
      }
      .icon-btn {
        position: relative;
      }
      .info { padding: 12px; display: grid; gap: 6px; }
      .title { font-weight: 700; }
      .subtitle { color: var(--muted); font-size: 14px; }
      .price-row-card { display: flex; justify-content: space-between; align-items: center; }
      .add-btn { background: var(--brand); color: #fff; border: none; padding: 8px 12px; border-radius: 10px; cursor: pointer; }
      .add-btn:hover { background: var(--brand-600); }

      /* Newsletter */
      .newsletter { margin: 40px 0; border: 1px solid var(--border); border-radius: 16px; padding: 24px; background: var(--card); display: grid; grid-template-columns: 1.2fr 0.8fr; gap: 16px; box-shadow: var(--shadow); }
      .newsletter form { display: flex; gap: 10px; }
      .newsletter input { flex: 1; padding: 12px 14px; border: 1px solid var(--border); border-radius: 12px; background: transparent; }
      .newsletter button { padding: 12px 16px; border-radius: 12px; border: none; background: var(--brand); color: #fff; cursor: pointer; }

      /* Footer */
      footer { border-top: 1px solid var(--border); padding: 28px 0; }
      .footer-grid { display: grid; grid-template-columns: 1.2fr repeat(3, 1fr); gap: 24px; }
      .muted { color: var(--muted); }

      /* Drawers */
      .overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.35); opacity: 0; pointer-events: none; transition: opacity .2s ease; z-index: 60; }
      .drawer { position: fixed; top: 0; right: 0; height: 100%; width: 360px; max-width: 90vw; background: var(--card); border-left: 1px solid var(--border); transform: translateX(100%); transition: transform .25s ease; box-shadow: var(--shadow); display: flex; flex-direction: column; z-index: 70; }
      .drawer-header { 
        display: flex; 
        justify-content: space-between; 
        align-items: center; 
        padding: 16px 20px; 
        border-bottom: 1px solid var(--border);
        background: var(--card);
      }
      .drawer-body { 
        padding: 20px; 
        overflow: auto; 
        flex: 1;
      }
      .drawer-footer { 
        margin-top: auto; 
        padding: 20px; 
        border-top: 1px solid var(--border); 
        display: grid; 
        gap: 12px;
        background: var(--card);
      }
      .open .overlay { opacity: 1; pointer-events: auto; }
      .open .drawer { transform: translateX(0); }

      /* Animations and Transitions */
      * { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
      
      .brand-mark { 
        animation: float 3s ease-in-out infinite;
        transform-origin: center;
      }
      
      @keyframes float {
        0%, 100% { transform: translateY(0px) rotate(0deg); }
        50% { transform: translateY(-3px) rotate(2deg); }
      }
      
      .card { 
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        transform: translateY(0);
      }
      
      .card:hover { 
        transform: translateY(-8px) scale(1.02);
        box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        border-color: var(--brand);
      }
      
      .add-btn {
        transition: all 0.2s ease;
        position: relative;
        overflow: hidden;
      }
      
      .add-btn:hover {
        transform: scale(1.05);
        box-shadow: 0 4px 12px rgba(91, 124, 250, 0.4);
      }
      
      .add-btn:active {
        transform: scale(0.95);
      }
      
      .add-btn::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
        transition: left 0.5s;
      }
      
      .add-btn:hover::before {
        left: 100%;
      }
      
      .nav-link {
        position: relative;
        transition: all 0.3s ease;
      }
      
      .nav-link::after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 50%;
        width: 0;
        height: 2px;
        background: var(--brand);
        transition: all 0.3s ease;
        transform: translateX(-50%);
      }
      
      .nav-link:hover::after {
        width: 100%;
      }
      
      .nav-link:hover {
        color: var(--brand);
        transform: translateY(-1px);
      }
      
      .search input:focus {
        transform: scale(1.02);
        box-shadow: 0 0 0 3px rgba(91, 124, 250, 0.1);
      }
      
      .btn {
        position: relative;
        overflow: hidden;
        transition: all 0.3s ease;
      }
      
      .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(0,0,0,0.15);
      }
      
      .btn.primary:hover {
        box-shadow: 0 8px 25px rgba(91, 124, 250, 0.4);
      }
      
      .hero h1 {
        animation: slideInUp 0.8s ease-out;
      }
      
      .hero p {
        animation: slideInUp 0.8s ease-out 0.2s both;
      }
      
      .cta-row {
        animation: slideInUp 0.8s ease-out 0.4s both;
      }
      
      .meta {
        animation: slideInUp 0.8s ease-out 0.6s both;
      }
      
      @keyframes slideInUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      
      .hero-media {
        animation: fadeInScale 1s ease-out 0.8s both;
      }
      
      @keyframes fadeInScale {
        from {
          opacity: 0;
          transform: scale(0.9);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }
      
      .grid {
        animation: fadeIn 0.6s ease-out;
      }
      
      @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
      }
      
      .card {
        animation: slideInUp 0.6s ease-out;
        animation-fill-mode: both;
      }
      
      .card:nth-child(1) { animation-delay: 0.1s; }
      .card:nth-child(2) { animation-delay: 0.2s; }
      .card:nth-child(3) { animation-delay: 0.3s; }
      .card:nth-child(4) { animation-delay: 0.4s; }
      .card:nth-child(5) { animation-delay: 0.5s; }
      .card:nth-child(6) { animation-delay: 0.6s; }
      
      .cart-count {
        animation: pulse 0.6s ease-out;
      }
      
      @keyframes pulse {
        0% { transform: scale(1); }
        50% { transform: scale(1.2); }
        100% { transform: scale(1); }
      }
      
      .drawer {
        transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }
      
      .overlay {
        transition: opacity 0.3s ease;
      }
      
      .icon-btn:hover {
        transform: scale(1.1);
        background: var(--accent);
      }
      
      .checkbox input[type="checkbox"] {
        transition: all 0.2s ease;
      }
      
      .checkbox input[type="checkbox"]:checked {
        transform: scale(1.1);
      }
      
      .price-row input:focus {
        transform: scale(1.02);
        border-color: var(--brand);
        box-shadow: 0 0 0 2px rgba(91, 124, 250, 0.1);
      }
      
      .newsletter input:focus {
        transform: scale(1.02);
        border-color: var(--brand);
        box-shadow: 0 0 0 2px rgba(91, 124, 250, 0.1);
      }
      
      .newsletter button:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(91, 124, 250, 0.4);
      }
      
      .footer-grid a:hover {
        color: var(--brand);
        transform: translateX(4px);
      }

      /* Ads strip */
      .ad-strip {
        border: 1px solid var(--border);
        background: var(--card);
        border-radius: 14px;
        box-shadow: var(--shadow);
        overflow: hidden;
        margin: 18px 0;
        min-height: 80px;
      }
      .ad-strip.full-bleed {
        width: 100vw;
        margin-left: calc(50% - 50vw);
        margin-right: calc(50% - 50vw);
        border-radius: 0;
      }
      .ad-viewport { overflow: hidden; }
      .ad-track {
        display: flex;
        gap: 20px;
        padding: 20px 0 20px 16px;
        will-change: transform;
        animation: scrollLeft 25s linear infinite;
      }
      .ad-track.reverse { animation-name: scrollRight; }
      .ad-strip:hover .ad-track { animation-play-state: paused; }
      .ad-item {
        display: inline-flex;
        align-items: center;
        gap: 12px;
        padding: 12px 16px;
        background: linear-gradient(135deg, #fff7ed, #ffffff);
        border: 1px solid var(--border);
        border-radius: 12px;
        box-shadow: var(--shadow);
        min-width: 140px;
      }
      .ad-item img { width: 60px; height: 60px; object-fit: cover; border-radius: 10px; }
      .ad-item .label { font-weight: 700; white-space: nowrap; font-size: 14px; }

      @keyframes scrollLeft {
        from { transform: translateX(0); }
        to { transform: translateX(-50%); }
      }
      @keyframes scrollRight {
        from { transform: translateX(-50%); }
        to { transform: translateX(0); }
      }
      
      /* Full-bleed promo slider (Diwali) */
      .promo {
        border-top: 1px solid var(--border);
        border-bottom: 1px solid var(--border);
        background: var(--card);
      }
      .promo.full-bleed {
        width: 100vw;
        margin-left: calc(50% - 50vw);
        margin-right: calc(50% - 50vw);
      }
      .promo-viewport { overflow: hidden; }
      .promo-track { display: flex; will-change: transform; transition: transform .6s ease; }
      .promo-slide { 
        width: 100vw; 
        height: 260px; 
        position: relative; 
        flex-shrink: 0;
        background: linear-gradient(135deg, #fff7ed, #ffffff);
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .promo-slide img { 
        max-width: 100%; 
        max-height: 100%; 
        width: auto;
        height: auto;
        object-fit: contain; 
        display: block; 
      }
      
      /* Toasts */
      .toaster { position: fixed; top: 16px; right: 16px; display: grid; gap: 10px; z-index: 1000; pointer-events: none; }
      .toast { background: var(--success); color: #ffffff; border: 1px solid rgba(0,0,0,0.1); border-radius: 12px; padding: 10px 12px; box-shadow: var(--shadow); display: flex; align-items: center; gap: 10px; pointer-events: auto; }
      .toast.enter { animation: toastIn .2s ease-out; }
      .toast.exit { animation: toastOut .2s ease-in forwards; }
      @keyframes toastIn { from { opacity: 0; transform: translateY(-6px); } to { opacity: 1; transform: translateY(0); } }
      @keyframes toastOut { to { opacity: 0; transform: translateY(-6px); } }
      
      /* Loading states */
      .loading {
        position: relative;
        overflow: hidden;
      }
      
      .loading::after {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
        animation: shimmer 1.5s infinite;
      }
      
      @keyframes shimmer {
        0% { left: -100%; }
        100% { left: 100%; }
      }
      
      /* Mobile */
      @media (max-width: 1100px) {
        .header-inner { grid-template-columns: auto 1fr auto; }
        .brand-name { font-size: 16px; }
        nav.primary { display: flex; gap: 8px; }
        #becomeSeller { display: none; }
        .hamburger { display: inline-flex; }
        .link-btn span { display: none; }
        .link-btn { padding: 6px; }
        .hero-inner { grid-template-columns: 1fr; }
        .layout { grid-template-columns: 1fr; }
        .filters { 
          position: fixed;
          top: 0;
          left: 0;
          width: 280px;
          max-width: 85vw;
          height: 100vh;
          z-index: 100;
          transform: translateX(-100%);
          transition: transform 0.3s ease;
          overflow-y: auto;
          border-radius: 0;
          margin: 0;
        }
        .filters.open {
          transform: translateX(0);
        }
        .filters-overlay {
          display: none;
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.5);
          z-index: 99;
        }
        .filters-overlay.active {
          display: block;
        }
        .grid { grid-template-columns: repeat(2, 1fr); }
        .newsletter { grid-template-columns: 1fr; }
        .footer-grid { grid-template-columns: 1fr 1fr; }
      }
      @media (max-width: 640px) {
        /* Prevent horizontal overflow */
        html, body { overflow-x: hidden; max-width: 100vw; }
        * { max-width: 100%; box-sizing: border-box; }
        
        .container { padding: 0 8px; }
        .hero h1 { font-size: 16px; line-height: 1.2; }
        .hero-title { position: relative; display: inline-block; }
        .hero-title::after {
          content: '';
          position: absolute; left: 0; right: 0; bottom: -4px; height: 2px;
          background: linear-gradient(90deg, var(--brand), transparent, var(--brand));
          background-size: 200% 100%;
          animation: underlineSlide 3.5s linear infinite;
          opacity: 0.6;
        }
        @keyframes underlineSlide {
          0% { background-position: 0% 50%; }
          100% { background-position: 200% 50%; }
        }
        .hero p { font-size: 12px; }
        .cta-row { gap: 8px; }
        .btn { padding: 6px 10px; border-radius: 8px; font-size: 12px; }
        .btn.primary { padding: 6px 10px; }
        
        /* Minimize notice bar */
        .notice { padding: 6px 8px; font-size: 11px; }
        
        /* Compact header */
        .header-inner { 
          padding: 6px 0; 
          gap: 4px; 
          min-width: 0;
          grid-template-columns: auto 1fr auto !important;
        }
        /* Adjust grid when search is hidden */
        .header-inner .search {
          display: none !important;
        }
        .header-inner > * { min-width: 0; }
        .brand-logo { width: 16px; height: 16px; display: block; border-radius: 4px; flex-shrink: 0; }
        .brand { 
          min-width: auto; 
          gap: 3px; 
          flex-shrink: 0; 
          max-width: fit-content;
          margin-left: 8px !important;
        }
        .brand-name { 
          display: block !important; 
          font-size: 9.5px; 
          text-transform: uppercase; 
          font-weight: 800;
          letter-spacing: 0.15px;
          white-space: nowrap;
          overflow: visible;
          text-overflow: clip;
          max-width: none;
          flex-shrink: 0;
          line-height: 1.1;
        }
        .header-search-icon {
          display: inline-flex !important; /* Show on mobile */
          padding: 5px;
          margin-left: 4px;
          border-radius: 6px;
          background: none;
          border: 1px solid var(--border);
          cursor: pointer;
          align-items: center;
          justify-content: center;
          color: var(--muted);
        }
        .header-search-icon:hover {
          background: var(--accent);
          color: var(--fg);
        }
        .header-search-icon svg {
          width: 16px;
          height: 16px;
        }
        .search { display: none !important; }
        /* Mobile search modal - only show on mobile */
        @media (max-width: 640px) {
          .mobile-search-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--bg);
            z-index: 110;
            flex-direction: column;
          }
          .mobile-search-modal.active {
            display: flex;
          }
          .mobile-search-header {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 16px;
            border-bottom: 1px solid var(--border);
            background: var(--card);
          }
          .mobile-search-input-wrapper {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 8px;
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 10px 14px;
          }
          .mobile-search-input-wrapper input {
            flex: 1;
            border: 0;
            outline: 0;
            background: transparent;
            font-size: 16px;
          }
          .mobile-search-results {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
          }
          .mobile-search-close {
            background: none;
            border: none;
            padding: 8px;
            cursor: pointer;
            color: var(--fg);
          }
        }
        .clear-btn { padding: 3px; }
        .icon-btn { padding: 5px; border-radius: 6px; min-width: 28px; }
        .icon-btn svg { width: 14px; height: 14px; }
        nav.primary { gap: 3px; flex-shrink: 0; }
        .link-btn { padding: 5px; min-width: auto; }
        .link-btn span { display: none; }
        .cart-count { padding: 1px 4px; font-size: 9px; }
        
        /* Hide hero section on mobile */
        .hero { display: none !important; }
        
        /* Filters drawer on mobile */
        .layout { grid-template-columns: 1fr !important; }
        .toolbar {
          display: flex;
          justify-content: space-between;
          align-items: center;
          gap: 8px;
          flex-wrap: wrap;
        }
        .filter-toggle-btn {
          display: inline-flex;
          align-items: center;
          gap: 6px;
          padding: 8px 12px;
          background: var(--brand);
          color: white;
          border: none;
          border-radius: 8px;
          font-size: 12px;
          font-weight: 600;
          cursor: pointer;
        }
        .filter-toggle-btn:hover {
          background: var(--brand-600);
        }
        .filter-toggle-btn {
          display: none;
        }
        @media (max-width: 640px) {
          .filter-toggle-btn {
            display: inline-flex;
          }
          #closeFiltersBtn {
            display: inline-flex !important;
          }
          .filters { 
            position: fixed;
            top: 0;
            left: 0;
            width: 280px;
            max-width: 85vw;
            height: 100vh;
            z-index: 100;
            transform: translateX(-100%);
            transition: transform 0.3s ease;
            overflow-y: auto;
            border-radius: 0;
            margin: 0;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
          }
          .filters.open {
            transform: translateX(0);
          }
          .filters-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 99;
            backdrop-filter: blur(2px);
          }
          .filters-overlay.active {
            display: block;
          }
        }
        
        /* Products in 3 columns */
        .grid { grid-template-columns: repeat(3, 1fr); gap: 4px; padding: 8px; }
        .card { border-radius: 6px; }
        .media { aspect-ratio: 1/1; }
        .info { padding: 4px; }
        .title { font-size: 10px; line-height: 1.2; }
        .subtitle { font-size: 9px; }
        .price-row-card { font-size: 10px; }
        .add-btn { padding: 4px 6px; font-size: 9px; border-radius: 4px; }
        
        .footer-grid { grid-template-columns: 1fr; }
        body { padding-bottom: 64px; }
        .mobile-tabbar { display: grid; }
        .hero-media { display: none; }
        .hero-inner { display: flex; flex-direction: column; gap: 8px; padding: 0 !important; }
        .hero-inner > div:first-child { display: flex; flex-direction: column; gap: 4px; }
        .hero-inner h1 { font-size: 14px; line-height: 1.1; position: relative; display: -webkit-box; -webkit-line-clamp: 2; line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; padding-right: 86px; margin-bottom: 8px; min-height: 72px; }
        .hero-inner h1::after { content: ''; position: absolute; left: 0; right: 86px; bottom: -4px; height: 2px; background: linear-gradient(90deg, var(--brand), transparent, var(--brand)); background-size: 200% 100%; animation: underlineSlide 3.5s linear infinite; opacity: 0.6; }
        .hero-inner h1::before { content: ''; display: block; width: 70px; height: 70px; background: url('display/hands to heaven logo.jpg') center/cover; border-radius: 12px; box-shadow: var(--shadow); position: absolute; right: 8px; top: 2px; z-index: 1; }
        .hero-inner p { font-size: 11px; margin: 20px 0 12px; }
        .hero-inline-logo { display: inline-block; width: 28px; height: 28px; margin-left: 6px; vertical-align: middle; }
        
        /* Banner adjustments for mobile */
        .promo-slide { height: 150px; }
        .promo-slide img { max-height: 150px; }
        
        /* Increase speed of scrolling product names on mobile */
        .ad-track {
          animation: scrollLeft 12s linear infinite !important;
        }
        .ad-track.reverse {
          animation: scrollRight 12s linear infinite !important;
        }
        
        /* Full-bleed sections */
        .promo.full-bleed, .ad-strip.full-bleed { 
          width: 100vw;
          margin-left: calc(-50vw + 50%);
          margin-right: calc(-50vw + 50%);
        }
      }
      /* Mobile tab bar */
      .mobile-tabbar { display: none; position: fixed; left: 0; right: 0; bottom: 0; z-index: 90; background: var(--card); border-top: 1px solid var(--border); box-shadow: var(--shadow); grid-template-columns: repeat(5, 1fr); }
      .mobile-tabbar button { background: none; border: none; padding: 10px 0; display: grid; place-items: center; gap: 6px; color: var(--muted); }
      .mobile-tabbar button:active { transform: translateY(1px); }
      .mobile-tabbar .active { color: var(--fg); }
      .mobile-badge { position: relative; }
      .mobile-badge span { position: absolute; top: -4px; right: -10px; background: var(--brand); color: #fff; border-radius: 999px; padding: 2px 6px; font-size: 11px; font-weight: 800; }

      /* Fullscreen modal overlay */
      .fullscreen-modal-overlay {
        position: fixed;
        top: 60px;
        left: 0;
        right: 0;
        bottom: 0;
        background: #ffffff;
        display: none;
        align-items: stretch;
        justify-content: center;
        z-index: 200;
        overflow-y: auto;
      }
      .fullscreen-modal-overlay.active { display: flex; }
      .fullscreen-modal {
        background: #ffffff;
        border-radius: 0;
        width: 100%;
        max-width: 1200px;
        min-height: calc(100vh - 60px);
        box-shadow: none;
        display: flex;
        flex-direction: column;
        gap: 24px;
        position: relative;
        padding: 40px clamp(24px, 5vw, 64px);
      }
      .fullscreen-modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding-bottom: 20px;
        border-bottom: 1px solid var(--border);
      }
      .fullscreen-modal-header h2 {
        margin: 0;
        font-size: 28px;
        font-weight: 700;
      }
      .fullscreen-modal-body {
        flex: 1;
        overflow-y: auto;
        padding: 20px 0;
      }
      .fullscreen-modal-footer {
        padding-top: 20px;
        border-top: 1px solid var(--border);
      }
      @media (max-width: 640px) {
        .fullscreen-modal {
          padding: 20px 16px;
        }
        .fullscreen-modal-header h2 {
          font-size: 22px;
        }
      }
      
      /* Login Modal */
      .login-modal-overlay {
        position: fixed;
        top: 60px;
        left: 0;
        right: 0;
        bottom: 0;
        background: var(--bg);
        backdrop-filter: blur(8px);
        display: none;
        justify-content: center;
        align-items: flex-start;
        z-index: 250;
        overflow-y: auto;
        padding: 20px;
      }
      .login-modal-overlay.active { display: flex; }
      .login-modal-container {
        position: relative;
        width: 100%;
        max-width: 420px;
        margin-top: 20px;
      }
      .signup-container {
        max-width: 600px;
      }
      .login-modal-close {
        position: absolute;
        top: -50px;
        right: 0;
        background: var(--card);
        border: 1px solid var(--border);
        border-radius: 50%;
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        color: var(--fg);
        box-shadow: var(--shadow);
        transition: all 0.3s ease;
        z-index: 10;
      }
      .login-modal-close:hover {
        background: var(--accent);
        border-color: var(--brand);
        transform: scale(1.1);
      }
      .login-modal-close svg {
        width: 20px;
        height: 20px;
      }
      .login-container {
        background: var(--card);
        padding: 40px;
        width: 100%;
        border-radius: 20px;
        box-shadow: var(--shadow), 0 8px 30px rgba(0,0,0,0.1);
        border: 1px solid var(--border);
      }
      .login-container h2 {
        text-align: center;
        margin-bottom: 25px;
        font-size: 28px;
        font-weight: 600;
        letter-spacing: 1px;
        color: var(--fg);
        font-family: 'Poppins', sans-serif;
      }
      .login-container .input-box {
        margin-bottom: 20px;
      }
      .login-container .input-box label {
        font-size: 14px;
        color: var(--fg);
        font-weight: 500;
        display: block;
        margin-bottom: 6px;
        font-family: 'Poppins', sans-serif;
      }
      .login-container .input-box input {
        width: 100%;
        padding: 12px;
        margin-top: 6px;
        border-radius: 10px;
        border: 1px solid var(--border);
        background: var(--bg);
        color: var(--fg);
        font-size: 15px;
        outline: none;
        box-sizing: border-box;
        font-family: 'Poppins', sans-serif;
        transition: all 0.3s ease;
      }
      .login-container .input-box input::placeholder {
        color: var(--muted);
      }
      .login-container .input-box input:focus {
        background: var(--bg);
        border: 1px solid var(--brand);
        box-shadow: 0 0 0 3px rgba(245, 158, 11, 0.1);
      }
      .login-container .btn {
        width: 100%;
        padding: 14px;
        background: var(--brand);
        border: none;
        color: #ffffff;
        font-size: 16px;
        border-radius: 12px;
        cursor: pointer;
        margin-top: 10px;
        transition: 0.3s;
        font-family: 'Poppins', sans-serif;
        font-weight: 500;
      }
      .login-container .btn:hover {
        background: var(--brand-600);
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(245, 158, 11, 0.4);
      }
      .login-container .btn:active {
        transform: translateY(0);
      }
      .login-container .links {
        margin-top: 18px;
        text-align: center;
        font-size: 14px;
        color: var(--fg);
        font-family: 'Poppins', sans-serif;
      }
      .login-container .links p {
        margin: 8px 0;
      }
      .login-container .links a {
        color: var(--brand);
        text-decoration: none;
        font-weight: 500;
        transition: color 0.3s ease;
      }
      .login-container .links a:hover {
        color: var(--brand-600);
        text-decoration: underline;
      }
      
      /* Signup Form Styling */
      .signup-container {
        max-width: 600px;
        margin: 0 auto;
      }
      .signup-header {
        text-align: center;
        margin-bottom: 32px;
      }
      .signup-header h2 {
        margin-bottom: 8px;
      }
      .signup-subtitle {
        font-size: 14px;
        opacity: 0.8;
        color: rgba(255, 255, 255, 0.9);
        margin: 0;
        font-weight: 400;
      }
      .signup-form {
        display: flex;
        flex-direction: column;
        gap: 24px;
      }
      .form-section-wrapper {
        background: var(--accent);
        border: 1px solid var(--border);
        border-radius: 16px;
        padding: 24px;
        transition: all 0.3s ease;
      }
      .form-section-wrapper:hover {
        background: var(--accent);
        border-color: var(--brand);
        box-shadow: 0 0 0 3px rgba(245, 158, 11, 0.1);
      }
      .form-section-header {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 20px;
        padding-bottom: 12px;
        border-bottom: 1px solid var(--border);
      }
      .form-section-header svg {
        color: var(--brand);
        flex-shrink: 0;
      }
      .form-section-header h3 {
        margin: 0;
        font-size: 16px;
        font-weight: 600;
        color: var(--fg);
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }
      .form-fields-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 16px;
      }
      .form-fields-grid .full-width {
        grid-column: 1 / -1;
      }
      .input-box label {
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 13px;
        font-weight: 500;
        margin-bottom: 8px;
        color: var(--fg);
      }
      .input-box label svg {
        width: 16px;
        height: 16px;
        color: var(--brand);
        flex-shrink: 0;
      }
      .input-box input {
        transition: all 0.3s ease;
      }
      .input-box input:focus {
        background: var(--bg);
        border: 1px solid var(--brand);
        box-shadow: 0 0 0 3px rgba(245, 158, 11, 0.1);
      }
      .error-message {
        color: #ff6b6b;
        font-size: 12px;
        margin-top: 6px;
        display: none;
        font-weight: 500;
        padding-left: 24px;
      }
      .error-message.show {
        display: block;
      }
      .terms-wrapper {
        background: var(--accent);
        border: 1px solid var(--border);
        border-radius: 12px;
        padding: 16px;
        margin-top: 8px;
      }
      .checkbox-label {
        display: flex;
        align-items: flex-start;
        gap: 12px;
        cursor: pointer;
        font-size: 13px;
        line-height: 1.5;
        color: var(--fg);
      }
      .checkbox-label input[type="checkbox"] {
        display: none;
      }
      .checkbox-custom {
        width: 20px;
        height: 20px;
        border: 2px solid var(--border);
        border-radius: 4px;
        background: var(--bg);
        flex-shrink: 0;
        margin-top: 2px;
        position: relative;
        transition: all 0.3s ease;
      }
      .checkbox-label input[type="checkbox"]:checked + .checkbox-custom {
        background: var(--brand);
        border-color: var(--brand);
      }
      .checkbox-label input[type="checkbox"]:checked + .checkbox-custom::after {
        content: '';
        position: absolute;
        left: 6px;
        top: 2px;
        width: 5px;
        height: 10px;
        border: solid white;
        border-width: 0 2px 2px 0;
        transform: rotate(45deg);
      }
      .checkbox-text {
        flex: 1;
      }
      .checkbox-text a {
        color: var(--brand);
        text-decoration: none;
        font-weight: 500;
        transition: color 0.3s ease;
      }
      .checkbox-text a:hover {
        color: var(--brand-600);
        text-decoration: underline;
      }
      .signup-submit-btn {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        margin-top: 8px;
        font-weight: 600;
        letter-spacing: 0.5px;
        text-transform: uppercase;
        font-size: 15px;
        padding: 16px;
        background: var(--brand);
        color: #ffffff;
      }
      .signup-submit-btn:hover {
        background: var(--brand-600);
      }
      .signup-submit-btn svg {
        transition: transform 0.3s ease;
      }
      .signup-submit-btn:hover svg {
        transform: translateX(4px);
      }
      
      .checkbox-box {
        margin-top: 8px;
      }
      .checkbox-box input[type="checkbox"] {
        width: 18px;
        height: 18px;
        cursor: pointer;
        accent-color: #ff6b00;
      }
      .checkbox-box label {
        font-size: 14px;
        opacity: 0.9;
      }
      .user-profile-content {
        display: flex;
        flex-direction: column;
        gap: 16px;
        margin-top: 20px;
      }
      .profile-field {
        display: flex;
        flex-direction: column;
        gap: 6px;
        padding: 14px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 8px;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }
      .profile-field-label {
        font-size: 12px;
        opacity: 0.8;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        color: #fff;
      }
      .profile-field-value {
        font-size: 16px;
        font-weight: 500;
        color: #fff;
      }
      #passwordMatchError {
        color: #ff6b6b;
        font-size: 12px;
        margin-top: 4px;
        display: none;
      }
      #passwordMatchError.show {
        display: block;
      }
      @media (max-width: 640px) {
        .login-modal-overlay {
          top: 60px;
          padding: 16px;
          align-items: flex-start;
        }
        .login-modal-container {
          margin-top: 0;
        }
        .login-modal-close {
          top: -40px;
          right: 0;
        }
        .login-container {
          padding: 30px 24px;
          max-height: 90vh;
          overflow-y: auto;
        }
        .login-container h2 {
          font-size: 24px;
        }
        .login-container .input-box {
          margin-bottom: 16px;
        }
        .login-container .input-box input {
          font-size: 16px; /* Prevents zoom on iOS */
        }
        .login-container .btn {
          padding: 14px;
          font-size: 16px;
        }
        .user-profile-content {
          gap: 12px;
        }
        .profile-field {
          padding: 12px;
        }
        .profile-field-label {
          font-size: 11px;
        }
        .profile-field-value {
          font-size: 15px;
        }
        .mobile-tabbar button {
          font-size: 11px;
        }
        .mobile-tabbar button span {
          font-size: 11px;
        }
        .form-fields-grid {
          grid-template-columns: 1fr;
        }
        .form-section-wrapper {
          padding: 20px;
        }
        .signup-header {
          margin-bottom: 24px;
        }
        .signup-header h2 {
          font-size: 24px;
        }
        .signup-subtitle {
          font-size: 13px;
        }
      }

      /* Checkout Modal */
      .checkout-modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.7);
        backdrop-filter: blur(4px);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 300;
        overflow-y: auto;
        padding: 20px;
      }
      .checkout-modal-overlay.active { display: flex; }
      .checkout-modal-container {
        position: relative;
        width: 100%;
        max-width: 800px;
        background: #ffffff;
        border-radius: 16px;
        box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        max-height: 90vh;
        overflow-y: auto;
        margin: auto;
        padding-bottom: 20px;
      }
      .checkout-modal-close {
        position: absolute;
        top: 16px;
        right: 16px;
        background: rgba(0, 0, 0, 0.05);
        border: none;
        border-radius: 50%;
        width: 36px;
        height: 36px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        color: var(--text);
        transition: all 0.3s ease;
        z-index: 10;
      }
      .checkout-modal-close:hover {
        background: rgba(0, 0, 0, 0.1);
        transform: scale(1.1);
      }
      .checkout-content {
        padding: 40px;
      }
      .checkout-content h2 {
        margin: 0 0 24px 0;
        font-size: 28px;
        font-weight: 700;
        color: var(--text);
      }
      .customer-type-toggle {
        display: flex;
        gap: 12px;
        margin-bottom: 32px;
        background: var(--accent);
        padding: 4px;
        border-radius: 12px;
      }
      .toggle-btn {
        flex: 1;
        padding: 12px 20px;
        border: none;
        background: transparent;
        color: var(--muted);
        font-size: 15px;
        font-weight: 500;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
      }
      .toggle-btn.active {
        background: #ffffff;
        color: var(--text);
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      }
      .checkout-form {
        display: flex;
        flex-direction: column;
        gap: 32px;
      }
      .form-section {
        display: flex;
        flex-direction: column;
        gap: 20px;
      }
      .form-section h3 {
        margin: 0;
        font-size: 18px;
        font-weight: 600;
        color: var(--text);
        padding-bottom: 12px;
        border-bottom: 2px solid var(--accent);
      }
      .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 16px;
      }
      .form-group {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }
      .form-group label {
        font-size: 14px;
        font-weight: 500;
        color: var(--text);
      }
      .form-group input {
        padding: 12px 16px;
        border: 1px solid var(--border);
        border-radius: 8px;
        font-size: 15px;
        outline: none;
        transition: all 0.3s ease;
        background: #ffffff;
      }
      .form-group input:focus {
        border-color: var(--primary);
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
      }
      .form-group input::placeholder {
        color: var(--muted);
      }
      .form-links {
        text-align: right;
        margin-top: -8px;
      }
      .form-links a {
        color: var(--primary);
        text-decoration: none;
        font-size: 14px;
        font-weight: 500;
      }
      .form-links a:hover {
        text-decoration: underline;
      }
      .checkout-order-summary {
        background: var(--accent);
        border-radius: 12px;
        padding: 16px;
        max-height: 300px;
        overflow-y: auto;
      }
      .checkout-order-item {
        display: flex;
        gap: 12px;
        padding: 12px 0;
        border-bottom: 1px solid rgba(0,0,0,0.05);
      }
      .checkout-order-item:last-child {
        border-bottom: none;
      }
      .checkout-order-item img {
        width: 60px;
        height: 60px;
        object-fit: cover;
        border-radius: 8px;
      }
      .checkout-order-item-details {
        flex: 1;
        display: flex;
        flex-direction: column;
        gap: 4px;
      }
      .checkout-order-item-details .item-name {
        font-weight: 500;
        color: var(--text);
        font-size: 14px;
      }
      .checkout-order-item-details .item-price {
        color: var(--muted);
        font-size: 13px;
      }
      .checkout-order-item-details .item-quantity {
        color: var(--muted);
        font-size: 12px;
      }
      .checkout-total {
        display: flex;
        flex-direction: column;
        gap: 12px;
        padding-top: 16px;
        border-top: 2px solid rgba(0,0,0,0.1);
      }
      .total-row {
        display: flex;
        justify-content: space-between;
        font-size: 15px;
        color: var(--text);
      }
      .total-row.total-final {
        font-size: 20px;
        font-weight: 700;
        padding-top: 12px;
        border-top: 2px solid rgba(0,0,0,0.1);
        margin-top: 4px;
      }
      .checkout-submit-btn {
        width: 100%;
        padding: 16px;
        background: var(--primary);
        color: #ffffff;
        border: none;
        border-radius: 12px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        margin-top: 8px;
      }
      .checkout-submit-btn:hover {
        background: #2563eb;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
      }
      .checkout-submit-btn:active {
        transform: translateY(0);
      }
      .address-list-container {
        display: grid;
        gap: 16px;
        margin-bottom: 24px;
      }
      .address-card {
        border: 2px solid var(--border);
        border-radius: 12px;
        padding: 20px;
        cursor: pointer;
        transition: all 0.3s ease;
        background: var(--card);
      }
      .address-card:hover {
        border-color: var(--primary);
        box-shadow: 0 4px 12px rgba(59, 130, 246, 0.1);
      }
      .address-card.selected {
        border-color: var(--primary);
        background: rgba(59, 130, 246, 0.05);
      }
      .address-card-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 12px;
      }
      .address-card-name {
        font-weight: 600;
        font-size: 16px;
        color: var(--text);
        margin-bottom: 4px;
      }
      .address-card-details {
        color: var(--muted);
        font-size: 14px;
        line-height: 1.6;
      }
      .address-card-radio {
        margin-top: 4px;
      }
      .no-address-message {
        padding: 40px 20px;
        text-align: center;
      }
      .checkout-skip-btn {
        width: 100%;
        padding: 14px;
        background: transparent;
        color: var(--brand);
        border: 2px solid var(--brand);
        border-radius: 12px;
        font-size: 15px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        margin-top: 12px;
      }
      .checkout-skip-btn:hover {
        background: var(--accent);
        border-color: var(--brand-600);
        color: var(--brand-600);
      }
      .checkout-skip-btn:active {
        transform: translateY(0);
      }
      
      /* Payment Method Selection */
      .payment-methods-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 16px;
        margin-top: 16px;
      }
      .payment-method-card {
        position: relative;
      }
      .payment-method-card input[type="radio"] {
        position: absolute;
        opacity: 0;
        pointer-events: none;
      }
      .payment-method-label {
        display: flex;
        align-items: center;
        gap: 16px;
        padding: 16px;
        border: 2px solid var(--border);
        border-radius: 12px;
        background: var(--card);
        cursor: pointer;
        transition: all 0.3s ease;
      }
      .payment-method-label:hover {
        border-color: var(--brand);
        background: var(--accent);
      }
      .payment-method-card input[type="radio"]:checked + .payment-method-label {
        border-color: var(--brand);
        background: var(--accent);
        box-shadow: 0 0 0 3px rgba(245, 158, 11, 0.1);
      }
      .payment-method-icon {
        width: 48px;
        height: 48px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: var(--bg);
        border-radius: 10px;
        color: var(--brand);
        flex-shrink: 0;
      }
      .payment-method-info {
        flex: 1;
      }
      .payment-method-name {
        font-size: 16px;
        font-weight: 600;
        color: var(--fg);
        margin-bottom: 4px;
      }
      .payment-method-desc {
        font-size: 13px;
        color: var(--muted);
      }
      @media (max-width: 640px) {
        .payment-methods-grid {
          grid-template-columns: 1fr;
        }
        .checkout-modal-overlay {
          padding: 0;
        }
        .checkout-modal-container {
          max-width: 100%;
          max-height: 100vh;
          border-radius: 0;
        }
        .checkout-content {
          padding: 24px 20px;
        }
        .checkout-content h2 {
          font-size: 24px;
        }
        .form-row {
          grid-template-columns: 1fr;
        }
        .customer-type-toggle {
          margin-bottom: 24px;
        }
        .toggle-btn {
          font-size: 14px;
          padding: 10px 16px;
        }
      }
      
      /* Product detail modal */
      .product-modal-overlay {
        position: fixed;
        top: 60px;
        left: 0;
        right: 0;
        bottom: 0;
        background: #ffffff;
        display: none;
        align-items: stretch;
        justify-content: center;
        z-index: 200;
        overflow-y: auto;
      }
      .product-modal-overlay.active { display: flex; }
      .product-modal {
        background: #ffffff;
        border-radius: 0;
        width: 100%;
        max-width: 1200px;
        min-height: 100vh;
        box-shadow: none;
        display: flex;
        flex-direction: column;
        gap: 24px;
        position: relative;
        padding: 40px clamp(24px, 5vw, 64px);
      }
      /* Header navigation buttons (shown when product modal is open) */
      .header-nav-buttons {
        display: none;
        gap: 8px;
        align-items: center;
      }
      .header-nav-buttons.active {
        display: flex;
      }
      .header-nav-btn {
        background: none;
        border: 1px solid var(--border);
        border-radius: 10px;
        padding: 8px;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        color: var(--fg);
        transition: all 0.2s ease;
      }
      .header-nav-btn:hover {
        background: var(--accent);
        border-color: var(--brand);
      }
      .header-nav-btn svg {
        width: 18px;
        height: 18px;
      }
      .product-modal-back {
        display: none;
      }
      .product-modal-body {
        display: grid;
        grid-template-columns: minmax(0, 1fr) minmax(0, 1.1fr);
        gap: 32px;
      }
      .product-modal-image {
        border-radius: 18px;
        overflow: hidden;
        background: linear-gradient(135deg, #fff7ed, #ffffff);
        box-shadow: var(--shadow);
      }
      .product-modal-image img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
      }
      .product-modal-info h2 {
        margin: 0 0 4px;
        font-size: 28px;
      }
      .product-modal-info p {
        margin: 0 0 16px;
        color: var(--muted);
      }
      .product-modal-price {
        font-size: 28px;
        font-weight: 800;
        margin-bottom: 12px;
      }
      .product-meta-list {
        display: grid;
        gap: 8px;
        margin-bottom: 16px;
      }
      .product-meta-item {
        background: var(--card);
        border: 1px solid var(--border);
        border-radius: 12px;
        padding: 12px;
      }
      .product-meta-item strong {
        display: block;
        font-size: 13px;
        color: var(--muted);
        margin-bottom: 4px;
        text-transform: uppercase;
        letter-spacing: 0.2px;
      }
      .product-modal-description {
        background: var(--card);
        border-radius: 12px;
        border: 1px solid var(--border);
        padding: 16px;
        line-height: 1.6;
      }
      .product-modal-actions {
        display: grid;
        grid-template-columns: repeat(2, minmax(0, 1fr));
        gap: 12px;
        margin-top: 20px;
      }
      .product-modal-actions button {
        border-radius: 12px;
        padding: 12px 18px;
        border: 1px solid var(--border);
        cursor: pointer;
        font-weight: 600;
        font-size: 15px;
      }
      .product-modal-actions .primary {
        background: var(--brand);
        color: #fff;
        border-color: transparent;
      }
      .product-modal-actions .primary:hover {
        background: var(--brand-600);
      }
      .product-query {
        border: 1px solid var(--border);
        border-radius: 14px;
        padding: 16px;
        background: var(--card);
        margin-top: 12px;
      }
      .product-query h3 { margin: 0 0 8px; }
      .product-query form {
        display: grid;
        gap: 10px;
      }
      .product-query textarea {
        min-height: 90px;
        border-radius: 12px;
        border: 1px solid var(--border);
        padding: 12px;
        font: inherit;
        resize: vertical;
      }
      .product-query button {
        justify-self: start;
        border: none;
        background: var(--brand);
        color: white;
        padding: 10px 20px;
        border-radius: 999px;
        cursor: pointer;
        font-weight: 600;
      }
      .product-modal-suggestions h3 {
        margin: 0 0 12px;
      }
      .suggestions-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 16px;
        padding: 16px;
      }
      .product-modal .card.suggestion-card {
        cursor: pointer;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
      }
      .product-modal .card.suggestion-card:hover {
        transform: translateY(-4px);
        box-shadow: var(--shadow);
        border-color: var(--brand);
      }
      .product-modal .card.suggestion-card .add-btn {
        display: none;
      }
      .product-modal-info-strip {
        background: #000;
        color: #f1f5f9;
        padding: 48px 0;
        width: 100vw;
        margin-left: calc(-50vw + 50%);
        margin-right: calc(-50vw + 50%);
        position: relative;
      }
      .product-modal-info-strip .content {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px;
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        gap: 24px;
      }
      .product-modal-info-strip h4 {
        margin: 0 0 8px;
        letter-spacing: 0.4px;
      }
      .product-modal-info-strip ul {
        list-style: none;
        padding: 0;
        margin: 0;
        display: grid;
        gap: 6px;
      }
      .product-modal-info-strip a {
        color: inherit;
        opacity: 0.85;
      }
      .product-modal-info-strip a:hover {
        opacity: 1;
      }
      .product-reviews {
        margin-top: 24px;
        border-top: 1px solid var(--border);
        padding-top: 24px;
        display: grid;
        gap: 16px;
      }
      .product-reviews h3 {
        margin: 0;
      }
      .review-card {
        border: 1px solid var(--border);
        border-radius: 12px;
        padding: 14px;
        background: var(--card);
        display: grid;
        gap: 6px;
      }
      .review-stars {
        color: #f59e0b;
        font-size: 14px;
      }
      .site-info {
        background: #000;
        color: #f1f5f9;
        padding: 48px 0;
      }
      .site-info .content {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        gap: 24px;
      }
      .site-info h4 {
        margin: 0 0 10px;
        letter-spacing: 0.4px;
      }
      .site-info ul {
        list-style: none;
        padding: 0;
        margin: 0;
        display: grid;
        gap: 6px;
      }
      .site-info a {
        color: inherit;
        opacity: 0.85;
      }
      .site-info a:hover {
        opacity: 1;
      }
      @media (max-width: 960px) {
        .product-modal-body {
          grid-template-columns: 1fr;
        }
        .suggestions-grid {
          grid-template-columns: repeat(3, 1fr);
          gap: 4px;
          padding: 8px;
        }
      }
    </style>
  </head>
  <body>
    <div class="notice">Free shipping over â‚¹500 â€¢ Easy 30-day returns</div>
    <header>
      <div class="container header-inner">
        <div style="display:flex; align-items:center; gap:12px;">
          <div class="header-nav-buttons" id="headerNavButtons">
            <button class="header-nav-btn" id="headerBackBtn" aria-label="Go back" title="Back">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                <path d="M15 5l-7 7 7 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
            <button class="header-nav-btn" id="headerForwardBtn" aria-label="Go forward" title="Forward" style="opacity:0.5; cursor:not-allowed;" disabled>
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                <path d="M9 5l7 7-7 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
          </div>
        <a class="brand" href="#" aria-label="Hands to Heaven home" style="gap:10px;">
          <img src="display/hands to heaven logo.jpg" alt="Hands to Heaven Logo" class="brand-logo" />
            <div class="brand-name">Hands to Heaven</div>
          </a>
        </div>
        <button class="header-search-icon" id="headerSearchIcon" aria-label="Search" title="Search">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <path d="M21 21l-3.8-3.8M10.5 18a7.5 7.5 0 100-15 7.5 7.5 0 000 15z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </button>
        <form class="search" id="searchForm" role="search" aria-label="Site" style="justify-self: stretch;">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M21 21l-3.8-3.8M10.5 18a7.5 7.5 0 100-15 7.5 7.5 0 000 15z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
          <input type="search" placeholder="Search for products, brands and more" aria-label="Search products" />
          <button type="button" id="clearSearch" class="clear-btn" aria-label="Clear search" title="Clear">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
          </button>
          <button type="submit">Search</button>
          <div class="search-dropdown" id="searchDropdown">
            <div class="search-list" id="searchList"></div>
          </div>
        </form>
        <nav class="primary" aria-label="Primary">
          <button class="link-btn" id="becomeSeller" aria-label="Become a Seller">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M3 10l9-6 9 6v7a2 2 0 01-2 2h-4v-5H9v5H5a2 2 0 01-2-2v-7z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
            <span>Become a Seller</span>
          </button>
          <button class="icon-btn" id="openFavorites" aria-label="Favorites">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
              <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
            </svg>
            <span class="favorites-count" id="favoritesCount">0</span>
          </button>
          <button class="icon-btn" id="openCart" aria-label="Open cart">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M3 3h2l1.5 12h11L21 6H6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><circle cx="9" cy="20" r="1.5" fill="currentColor"/><circle cx="17" cy="20" r="1.5" fill="currentColor"/></svg>
            <span class="cart-count" id="cartCount">0</span>
          </button>
          <div class="dropdown" id="moreMenu">
            <button class="icon-btn" id="moreMenuBtn" aria-haspopup="menu" aria-expanded="false" aria-label="More options">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                <circle cx="5" cy="12" r="2" fill="currentColor"/>
                <circle cx="12" cy="12" r="2" fill="currentColor"/>
                <circle cx="19" cy="12" r="2" fill="currentColor"/>
              </svg>
            </button>
            <div class="dropdown-menu" role="menu" aria-label="More options">
              <a class="menu-item" href="#about" role="menuitem">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M12 12v6m0-12h.01M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9 9 4.03 9 9z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
                About
              </a>
            </div>
          </div>
          <button class="link-btn" id="loginBtn" aria-label="Login" style="margin-left:4px;">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M12 12a5 5 0 100-10 5 5 0 000 10zM3 22a9 9 0 1118 0" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
            <span>Login</span>
          </button>
          <button class="link-btn" id="helpBtn" aria-label="Help" style="margin-left:4px;">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M12 12v6m0-12h.01M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9 9 4.03 9 9z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
            <span>Help</span>
          </button>
        </nav>
      </div>
    </header>

    <main>
      <section class="hero">
        <div class="container hero-inner" style="display:flex; justify-content:center; padding:48px 0;">
          <a class="brand" href="#" aria-label="Hands to Heaven home" style="gap:12px;">
            <img src="display/hands to heaven logo.jpg" alt="Hands to Heaven Logo" class="brand-logo" />
            <div class="brand-name">Hands to Heaven</div>
          </a>
        </div>
      </section>

      <div class="ad-strip full-bleed" aria-label="Resin products highlight (bottom)">
        <div class="ad-viewport">
          <div class="ad-track" id="adsBottom"></div>
        </div>
      </div>

      <!-- Promo slider -->
      <section class="promo full-bleed" aria-label="Promotional banners" style="margin: 16px 0 0;">
        <div class="promo-viewport">
          <div class="promo-track" id="promoTrack">
            <div class="promo-slide">
              <img src="display/ADD BANNERS/add banner 1.jpeg" alt="Promotional banner 1" onerror="this.style.display='none'; this.parentElement.innerHTML='<div style=\'color:var(--muted); font-size:14px;\'>Banner 1</div>';">
            </div>
            <div class="promo-slide">
              <img src="display/ADD BANNERS/add banner 2.png" alt="Promotional banner 2" onerror="this.style.display='none'; this.parentElement.innerHTML='<div style=\'color:var(--muted); font-size:14px;\'>Banner 2</div>';">
            </div>
            <div class="promo-slide">
              <img src="display/ADD BANNERS/add banner 3.png" alt="Promotional banner 3" onerror="this.style.display='none'; this.parentElement.innerHTML='<div style=\'color:var(--muted); font-size:14px;\'>Banner 3</div>';">
            </div>
            <div class="promo-slide">
              <img src="display/ADD BANNERS/add banner 4.png" alt="Promotional banner 4" onerror="this.style.display='none'; this.parentElement.innerHTML='<div style=\'color:var(--muted); font-size:14px;\'>Banner 4</div>';">
            </div>
          </div>
        </div>
      </section>

      <div class="filters-overlay" id="filtersOverlay"></div>
      <div class="container layout" id="products">
        <aside class="filters" aria-label="Filters">
          <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:12px;">
            <h3 style="margin:0;">Filters</h3>
            <button class="icon-btn" id="closeFiltersBtn" aria-label="Close filters" style="display:none;">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
            </button>
          </div>
          <div class="filter-group">
            <div class="subtitle">Category</div>
            <label class="checkbox"><input type="checkbox" value="ring" /> Ring</label>
            <label class="checkbox"><input type="checkbox" value="pendant" /> Pendant</label>
            <label class="checkbox"><input type="checkbox" value="keychain" /> Keychain</label>
            <label class="checkbox"><input type="checkbox" value="frame" /> Frame</label>
            <label class="checkbox"><input type="checkbox" value="ear-ring" /> Ear-ring</label>
            <label class="checkbox"><input type="checkbox" value="flower" /> Flower</label>
          </div>
          <button class="btn" style="margin-top:12px;width:100%" id="applyFiltersBtn">Apply filters</button>
        </aside>

        <section class="products-card">
          <div class="toolbar">
          <div class="subtitle">Showing <span id="productCount">0</span> products</div>
            <div style="display:flex; gap:10px; align-items:center; flex-wrap: wrap;">
              <button class="filter-toggle-btn" id="filterToggleBtn" aria-label="Toggle filters">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M3 6h18M7 12h10M11 18h2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
                Filter
              </button>
              <label for="sort" class="subtitle">Sort</label>
              <select id="sort" style="padding:8px 10px; border:1px solid var(--border); border-radius:10px; background:transparent;">
                <option>Featured</option>
                <option>Price: Low to High</option>
                <option>Price: High to Low</option>
                <option>Newest</option>
              </select>
            </div>
          </div>
          <div class="grid" id="productsGrid"></div>
        </section>
      </div>

      <div class="container">
        <section class="newsletter">
          <div>
            <h2>Join the Inner Circle</h2>
            <p class="muted">Get early access, exclusive offers, and calm in your inbox.</p>
          </div>
          <form id="newsletterForm">
            <input type="email" placeholder="Enter your email" aria-label="Email" required />
            <button type="submit">Subscribe</button>
          </form>
        </section>
      </div>
    </main>

    <footer>
      <div class="container footer-grid">
        <div>
          <div class="brand" style="margin-bottom:8px;">
            <img src="display/hands to heaven logo.jpg" alt="Hands to Heaven Logo" class="brand-logo" />
            <div class="brand-name">Hands to Heaven</div>
          </div>
          <div class="muted">Quiet luxury for everyday living.</div>
        </div>
        <div>
          <div class="title">Shop</div>
          <div><a class="muted" href="#">New arrivals</a></div>
          <div><a class="muted" href="#">Best sellers</a></div>
          <div><a class="muted" href="#">Gift cards</a></div>
        </div>
        <div>
          <div class="title">Company</div>
          <div><a class="muted" href="#">About</a></div>
          <div><a class="muted" href="#">Sustainability</a></div>
          <div><a class="muted" href="#">Careers</a></div>
        </div>
        <div>
          <div class="title">Help</div>
          <div><a class="muted" href="#">Shipping</a></div>
          <div><a class="muted" href="#">Returns</a></div>
          <div><a class="muted" href="#">Contact</a></div>
        </div>
      </div>
      <div class="container" style="margin-top:16px; color:var(--muted); font-size:14px;">Â© <span id="year"></span> Hands to Heaven. All rights reserved.</div>
    </footer>

    <section class="site-info">
      <div class="container content">
        <div>
          <h4>About</h4>
          <ul>
            <li><a href="#contact">Contact us</a></li>
            <li><a href="#about">About us</a></li>
            <li><a href="#careers">Careers</a></li>
          </ul>
        </div>
        <div>
          <h4>About the Startup</h4>
          <p style="margin:0; color:rgba(241,245,249,0.85); line-height:1.5;">
            Hands to Heaven is a craft-first studio that preserves memories through bespoke resin and floral keepsakes. We work with local artisans and sustainable sourcing.
          </p>
        </div>
        <div>
          <h4>Owner of HTH</h4>
          <p style="margin:0; color:rgba(241,245,249,0.85); line-height:1.5;">
            Founded by Princi Lodhi, designer & storyteller, whose mission is to bring warmth and meaning to everyday luxury.
          </p>
        </div>
        <div>
          <h4>Help</h4>
          <ul>
            <li><a href="#payments">Payments</a></li>
            <li><a href="#shipping">Shipping</a></li>
            <li><a href="#returns">Cancellation & Return</a></li>
          </ul>
        </div>
        <div>
          <h4>Customisation</h4>
          <ul>
            <li><a href="#custom">Book a custom order</a></li>
            <li><a href="#bulk">Bulk & corporate gifts</a></li>
            <li><a href="#care">Care & material guide</a></li>
          </ul>
        </div>
        <div>
          <h4>Social</h4>
          <ul>
            <li><a href="https://instagram.com" target="_blank" rel="noreferrer">Instagram</a></li>
            <li><a href="https://youtube.com" target="_blank" rel="noreferrer">YouTube</a></li>
            <li><a href="https://facebook.com" target="_blank" rel="noreferrer">Facebook</a></li>
            <li><a href="https://wa.me/1234567890" target="_blank" rel="noreferrer">WhatsApp</a></li>
          </ul>
        </div>
      </div>
    </section>

    <!-- Mobile Search Modal -->
    <div id="mobileSearchModal" class="mobile-search-modal" aria-hidden="true">
      <div class="mobile-search-header">
        <div class="mobile-search-input-wrapper">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <path d="M21 21l-3.8-3.8M10.5 18a7.5 7.5 0 100-15 7.5 7.5 0 000 15z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
          <input type="search" id="mobileSearchInput" placeholder="Search for products, brands and more" aria-label="Search products" />
          <button type="button" id="mobileClearSearch" class="clear-btn" aria-label="Clear search" style="display:none;">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
              <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
          </button>
        </div>
        <button class="mobile-search-close" id="closeMobileSearch" aria-label="Close search">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </button>
      </div>
      <div class="mobile-search-results" id="mobileSearchResults"></div>
    </div>

    <!-- Product detail modal -->
    <div id="productModalOverlay" class="product-modal-overlay" aria-hidden="true">
      <div class="product-modal" role="dialog" aria-modal="true" aria-labelledby="productModalTitle">
        <div class="product-modal-body">
          <div class="product-modal-image">
            <img id="productModalImage" alt="Product preview" />
          </div>
          <div class="product-modal-info">
            <h2 id="productModalTitle"></h2>
            <p id="productModalSubtitle"></p>
            <div class="product-modal-price" id="productModalPrice"></div>
            <div class="product-meta-list">
              <div class="product-meta-item">
                <strong>Delivery & Charges</strong>
                <div id="productModalDelivery"></div>
              </div>
              <div class="product-meta-item">
                <strong>Offers & Coupons</strong>
                <ul id="productModalOffers" style="padding-left:18px; margin:0;"></ul>
              </div>
            </div>
            <div class="product-modal-description" id="productModalDescription"></div>
            <div class="product-modal-actions">
              <button class="primary" id="modalAddToCartBtn">Add to cart</button>
              <button class="btn" id="modalBuyNowBtn">Buy now</button>
            </div>
            <div class="product-query">
              <h3>Have a question?</h3>
              <form id="productQueryForm">
                <textarea id="productQueryInput" placeholder="Ask about size, delivery, customization..." required></textarea>
                <button type="submit">Send message</button>
              </form>
            </div>
          </div>
        </div>
        <div class="product-modal-suggestions">
          <h3>Suggested for you</h3>
          <div class="suggestions-grid" id="productSuggestions"></div>
        </div>
        <div class="product-reviews" id="productReviews">
          <h3>Rating & Reviews</h3>
          <div class="no-reviews-message" style="text-align: center; padding: 40px 20px; color: var(--muted);">
            <p style="margin: 0; font-size: 16px;">No reviews yet</p>
            <p style="margin: 8px 0 0; font-size: 14px;">Be the first to review this product!</p>
          </div>
        </div>
        <div class="product-modal-info-strip">
          <div class="content">
            <div>
              <h4>About</h4>
              <ul>
                <li><a href="#contact">Contact us</a></li>
                <li><a href="#about">About us</a></li>
                <li><a href="#careers">Careers</a></li>
              </ul>
            </div>
            <div>
              <h4>About the Startup</h4>
              <p style="margin:0; color:rgba(241,245,249,0.85); line-height:1.5;">
              Hands to Heaven is a craft-first studio that preserves memories through bespoke resin and floral keepsakes. We work with local artisans and sustainable sourcing.
              </p>
            </div>
            <div>
              <h4>Owner of HTH</h4>
              <p style="margin:0; color:rgba(241,245,249,0.85); line-height:1.5;">
              Founded by Princi Lodhi, designer & storyteller, whose mission is to bring warmth and meaning to everyday luxury.
              </p>
            </div>
            <div>
              <h4>Help</h4>
              <ul>
                <li><a href="#payments">Payments</a></li>
                <li><a href="#shipping">Shipping</a></li>
                <li><a href="#returns">Cancellation & Return</a></li>
              </ul>
            </div>
            <div>
              <h4>Customisation</h4>
              <ul>
                <li><a href="#custom">Book a custom order</a></li>
                <li><a href="#bulk">Bulk & corporate gifts</a></li>
                <li><a href="#care">Care & material guide</a></li>
              </ul>
            </div>
            <div>
              <h4>Social</h4>
              <ul>
                <li><a href="https://instagram.com" target="_blank" rel="noreferrer">Instagram</a></li>
                <li><a href="https://youtube.com" target="_blank" rel="noreferrer">YouTube</a></li>
                <li><a href="https://facebook.com" target="_blank" rel="noreferrer">Facebook</a></li>
                <li><a href="https://wa.me/1234567890" target="_blank" rel="noreferrer">WhatsApp</a></li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Overlays / Drawers -->
    <div id="overlay" class="overlay" aria-hidden="true"></div>
    <div id="toaster" class="toaster" aria-live="polite" aria-atomic="true"></div>
    <!-- Phone preview modal -->
    <div id="phoneOverlay" class="phone-overlay" aria-hidden="true" aria-label="Phone preview modal">
      <div class="phone-frame">
        <div class="phone-notch"></div>
        <button class="phone-close" id="closePhoneView">Close</button>
        <iframe class="phone-iframe" id="phoneIframe" title="Phone preview"></iframe>
      </div>
    </div>
    <!-- Chatbot Modal -->
    <div id="chatbotOverlay" class="chatbot-overlay" aria-hidden="true">
      <div class="chatbot-container">
        <div class="chatbot-header">
          <div class="chatbot-header-content">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
              <path d="M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
            <h3>Help & Support</h3>
          </div>
          <button class="chatbot-close" id="closeChatbot" aria-label="Close chatbot">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
              <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
          </button>
        </div>
        <div class="chatbot-messages" id="chatbotMessages">
          <div class="chatbot-message bot">
            <div class="message-content">
              <p>Hello! I'm here to help you with questions about our resin products, orders, shipping, customization, and more. How can I assist you today?</p>
            </div>
          </div>
        </div>
        <div class="chatbot-input-container">
          <input type="text" id="chatbotInput" class="chatbot-input" placeholder="Type your question here..." aria-label="Chat input">
          <button class="chatbot-send" id="chatbotSend" aria-label="Send message">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
              <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
        </div>
      </div>
    </div>

    <!-- Login Modal -->
    <div id="loginModalOverlay" class="login-modal-overlay" aria-hidden="true">
      <div class="login-modal-container">
        <button class="login-modal-close" id="closeLoginModal" aria-label="Close login">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </button>
        <div class="login-container" id="loginContainer">
          <h2>Welcome Back</h2>
          <form id="loginForm">
            <div class="input-box">
              <label>Email Address</label>
              <input type="email" id="loginEmail" placeholder="Enter your email" required />
            </div>
            <div class="input-box">
              <label>Password</label>
              <input type="password" id="loginPassword" placeholder="Enter your password" required />
            </div>
            <button type="submit" class="btn">Login</button>
            <div class="links">
              <p><a href="#" id="forgotPasswordLink">Forgot Password?</a></p>
              <p>Don't have an account? <a href="#" id="createAccountLink">Create one</a></p>
            </div>
          </form>
        </div>
        <!-- Signup Form (hidden by default) -->
        <div class="login-container signup-container" id="signupContainer" style="display: none;">
          <div class="signup-header">
            <h2>Create Your Account</h2>
            <p class="signup-subtitle">Join Hands to Heaven and start your journey</p>
          </div>
          <form id="signupForm" class="signup-form">
            <!-- Personal Information Section -->
            <div class="form-section-wrapper">
              <div class="form-section-header">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                  <circle cx="12" cy="7" r="4" stroke="currentColor" stroke-width="2"/>
                </svg>
                <h3>Personal Information</h3>
              </div>
              <div class="form-fields-grid">
                <div class="input-box">
                  <label>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                      <circle cx="12" cy="7" r="4" stroke="currentColor" stroke-width="2"/>
                    </svg>
                    Full Name *
                  </label>
                  <input type="text" id="signupName" placeholder="Abhay Tiwari" required />
                </div>
                <div class="input-box">
                  <label>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" stroke="currentColor" stroke-width="2"/>
                      <polyline points="22,6 12,13 2,6" stroke="currentColor" stroke-width="2"/>
                    </svg>
                    Email Address *
                  </label>
                  <input type="email" id="signupEmail" placeholder="abhay.tiwari@example.com" required />
                </div>
                <div class="input-box">
                  <label>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z" stroke="currentColor" stroke-width="2"/>
                    </svg>
                    Phone Number *
                  </label>
                  <input type="tel" id="signupPhone" placeholder="+91 9876543210" required />
                </div>
              </div>
            </div>

            <!-- Security Section -->
            <div class="form-section-wrapper">
              <div class="form-section-header">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <rect x="3" y="11" width="18" height="11" rx="2" stroke="currentColor" stroke-width="2"/>
                  <path d="M7 11V7a5 5 0 0 1 10 0v4" stroke="currentColor" stroke-width="2"/>
                </svg>
                <h3>Security</h3>
              </div>
              <div class="form-fields-grid">
                <div class="input-box">
                  <label>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <rect x="3" y="11" width="18" height="11" rx="2" stroke="currentColor" stroke-width="2"/>
                      <path d="M7 11V7a5 5 0 0 1 10 0v4" stroke="currentColor" stroke-width="2"/>
                    </svg>
                    Password *
                  </label>
                  <input type="password" id="signupPassword" placeholder="Create a strong password" required />
                </div>
                <div class="input-box">
                  <label>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <rect x="3" y="11" width="18" height="11" rx="2" stroke="currentColor" stroke-width="2"/>
                      <path d="M7 11V7a5 5 0 0 1 10 0v4" stroke="currentColor" stroke-width="2"/>
                    </svg>
                    Confirm Password *
                  </label>
                  <input type="password" id="signupConfirmPassword" placeholder="Re-enter your password" required />
                  <span id="passwordMatchError" class="error-message">Passwords do not match</span>
                </div>
              </div>
            </div>

            <!-- Terms and Conditions -->
            <div class="terms-wrapper">
              <label class="checkbox-label">
                <input type="checkbox" id="signupPrivacyPolicy" required />
                <span class="checkbox-custom"></span>
                <span class="checkbox-text">I agree to the <a href="#" target="_blank">Privacy Policy</a> and <a href="#" target="_blank">Terms of Service</a> *</span>
              </label>
            </div>

            <button type="submit" class="btn signup-submit-btn">
              <span>Create Account</span>
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M5 12h14M12 5l7 7-7 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
            <div class="links">
              <p>Already have an account? <a href="#" id="backToLoginLink">Sign In</a></p>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- User Profile Modal -->
    <div id="userProfileModalOverlay" class="login-modal-overlay" aria-hidden="true">
      <div class="login-modal-container">
        <button class="login-modal-close" id="closeUserProfileModal" aria-label="Close profile">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </button>
        <div class="login-container">
          <h2>My Profile</h2>
          <div id="userProfileContent" class="user-profile-content">
            <!-- User data will be populated here -->
          </div>
          <div class="links" style="margin-top: 24px;">
            <button type="button" class="btn" id="logoutBtn" style="background: #ef4444; margin-top: 12px;">Logout</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Checkout Modal -->
    <div id="checkoutModalOverlay" class="checkout-modal-overlay" aria-hidden="true">
      <div class="checkout-modal-container">
        <button class="checkout-modal-close" id="closeCheckoutModal" aria-label="Close checkout">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </button>
        <div class="checkout-content">
          <h2>Checkout</h2>
          
          <!-- Login/Signup Section (shown only if not logged in) -->
          <div id="checkoutLoginSignupSection">
            <!-- Customer Type Toggle -->
            <div class="customer-type-toggle">
              <button type="button" class="toggle-btn active" id="newCustomerBtn">New Customer</button>
              <button type="button" class="toggle-btn" id="existingCustomerBtn">Already Have Account</button>
            </div>

            <!-- New Customer Signup Form -->
            <form id="checkoutForm" class="checkout-form">
              <div class="form-section">
                <h3>Create Account to Continue</h3>
                <div class="form-group">
                  <label for="checkoutSignupEmail">Email Address *</label>
                  <input type="email" id="checkoutSignupEmail" placeholder="Enter your email" required />
                </div>
                <div class="form-group">
                  <label for="checkoutSignupPassword">Password *</label>
                  <input type="password" id="checkoutSignupPassword" placeholder="Create a password" required />
                </div>
                <div class="form-group">
                  <label for="checkoutSignupConfirmPassword">Confirm Password *</label>
                  <input type="password" id="checkoutSignupConfirmPassword" placeholder="Confirm password" required />
                  <span id="checkoutPasswordMatchError" class="error-message">Passwords do not match</span>
                </div>
              </div>

              <div class="form-section">
                <h3>Order Summary</h3>
                <div id="checkoutOrderSummary" class="checkout-order-summary">
                  <!-- Order items will be populated here -->
                </div>
                <div class="checkout-total">
                  <div class="total-row">
                    <span>Subtotal</span>
                    <span id="checkoutSubtotal">â‚¹0.00</span>
                  </div>
                  <div class="total-row">
                    <span>Delivery Charges</span>
                    <span id="checkoutDelivery">â‚¹50.00</span>
                  </div>
                  <div class="total-row total-final">
                    <span>Total</span>
                    <span id="checkoutTotal">â‚¹0.00</span>
                  </div>
                </div>
              </div>

              <button type="submit" class="btn checkout-submit-btn">Create Account</button>
            </form>
            
            <!-- Continue to Address Button (shown after successful login/signup) -->
            <div id="continueToAddressSection" class="checkout-form" style="display: none;">
              <div class="form-section">
                <div style="text-align: center; padding: 20px; background: var(--accent); border-radius: 12px; margin-bottom: 24px;">
                  <svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin: 0 auto 12px; color: #10b981;">
                    <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                  <h3 style="margin: 0 0 8px 0; color: var(--text);">Account Created Successfully!</h3>
                  <p style="margin: 0; color: var(--muted);">Please continue to add your delivery address.</p>
                </div>
              </div>
              
              <div class="form-section">
                <h3>Order Summary</h3>
                <div id="continueOrderSummary" class="checkout-order-summary">
                  <!-- Order items will be populated here -->
                </div>
                <div class="checkout-total">
                  <div class="total-row">
                    <span>Subtotal</span>
                    <span id="continueSubtotal">â‚¹0.00</span>
                  </div>
                  <div class="total-row">
                    <span>Delivery Charges</span>
                    <span id="continueDelivery">â‚¹50.00</span>
                  </div>
                  <div class="total-row total-final">
                    <span>Total</span>
                    <span id="continueTotal">â‚¹0.00</span>
                  </div>
                </div>
              </div>
              
              <div class="form-section" style="margin-top: 32px; padding-top: 24px; border-top: 2px solid var(--border);">
                <button type="button" class="btn checkout-submit-btn" id="continueToAddressBtn" style="width: 100%; padding: 20px; font-size: 18px; font-weight: 700; background: var(--primary); color: #ffffff; border: none; border-radius: 12px; cursor: pointer; box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);">
                  <span style="display: flex; align-items: center; justify-content: center; gap: 8px;">
                    Continue to Address
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M5 12h14M12 5l7 7-7 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                  </span>
                </button>
              </div>
            </div>

            <!-- Existing Customer Login Form -->
            <form id="checkoutLoginForm" class="checkout-form" style="display: none;">
              <div class="form-section">
                <h3>Login to Continue</h3>
                <div class="form-group">
                  <label for="checkoutLoginEmail">Email Address *</label>
                  <input type="email" id="checkoutLoginEmail" placeholder="Enter your email" required />
                </div>
                <div class="form-group">
                  <label for="checkoutLoginPassword">Password *</label>
                  <input type="password" id="checkoutLoginPassword" placeholder="Enter your password" required />
                </div>
                <div class="form-links">
                  <a href="#" id="checkoutForgotPassword">Forgot Password?</a>
                </div>
              </div>

              <div class="form-section">
                <h3>Order Summary</h3>
                <div id="checkoutLoginOrderSummary" class="checkout-order-summary">
                  <!-- Order items will be populated here -->
                </div>
                <div class="checkout-total">
                  <div class="total-row">
                    <span>Subtotal</span>
                    <span id="checkoutLoginSubtotal">â‚¹0.00</span>
                  </div>
                  <div class="total-row">
                    <span>Delivery Charges</span>
                    <span id="checkoutLoginDelivery">â‚¹50.00</span>
                  </div>
                  <div class="total-row total-final">
                    <span>Total</span>
                    <span id="checkoutLoginTotal">â‚¹0.00</span>
                  </div>
                </div>
              </div>

              <button type="submit" class="btn checkout-submit-btn">Login</button>
            </form>
            
            <!-- Continue to Address Button for Login (shown after successful login) -->
            <div id="continueToAddressSectionLogin" class="checkout-form" style="display: none; width: 100%;">
              <div class="form-section">
                <div style="text-align: center; padding: 20px; background: var(--accent); border-radius: 12px; margin-bottom: 24px;">
                  <svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin: 0 auto 12px; color: #10b981;">
                    <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                  <h3 style="margin: 0 0 8px 0; color: var(--text);">Login Successful!</h3>
                  <p style="margin: 0; color: var(--muted);">Please continue to add your delivery address.</p>
                </div>
              </div>
              
              <div class="form-section">
                <h3>Order Summary</h3>
                <div id="continueOrderSummaryLogin" class="checkout-order-summary">
                  <!-- Order items will be populated here -->
                </div>
                <div class="checkout-total">
                  <div class="total-row">
                    <span>Subtotal</span>
                    <span id="continueSubtotalLogin">â‚¹0.00</span>
                  </div>
                  <div class="total-row">
                    <span>Delivery Charges</span>
                    <span id="continueDeliveryLogin">â‚¹50.00</span>
                  </div>
                  <div class="total-row total-final">
                    <span>Total</span>
                    <span id="continueTotalLogin">â‚¹0.00</span>
                  </div>
                </div>
              </div>
              
              <div class="form-section" style="margin-top: 32px; padding-top: 24px; border-top: 2px solid var(--border);">
                <button type="button" class="btn checkout-submit-btn" id="continueToAddressBtnLogin" style="width: 100%; padding: 20px; font-size: 18px; font-weight: 700; background: var(--primary); color: #ffffff; border: none; border-radius: 12px; cursor: pointer; box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);">
                  <span style="display: flex; align-items: center; justify-content: center; gap: 8px;">
                    Continue to Address
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M5 12h14M12 5l7 7-7 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                  </span>
                </button>
              </div>
            </div>
          </div>

          <!-- Address Selection Interface (shown for logged-in users on Buy Now) -->
          <div id="addressSelectionSection" class="checkout-form" style="display: none;">
            <div class="form-section">
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                <h3 style="margin: 0;">Select Delivery Address</h3>
                <button type="button" class="btn" id="addNewAddressBtn" style="padding: 8px 16px; font-size: 14px; background: var(--primary); color: #ffffff; border: none; border-radius: 8px; cursor: pointer; display: flex; align-items: center; gap: 6px;">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                  </svg>
                  Add New
                </button>
              </div>
              <div id="addressListContainer" class="address-list-container">
                <!-- Address cards will be populated here -->
              </div>
              <div id="noAddressMessage" class="no-address-message" style="display: none; text-align: center; padding: 40px 20px;">
                <svg width="64" height="64" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin: 0 auto 16px; color: var(--muted);">
                  <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z" stroke="currentColor" stroke-width="2"/>
                  <circle cx="12" cy="10" r="3" stroke="currentColor" stroke-width="2"/>
                </svg>
                <h4 style="margin: 0 0 8px 0; color: var(--text);">No Address Found</h4>
                <p style="margin: 0 0 24px 0; color: var(--muted);">You haven't placed any orders yet. Add your first delivery address.</p>
                <button type="button" class="btn checkout-submit-btn" id="addFirstAddressBtn" style="width: auto; padding: 12px 24px; display: inline-flex; align-items: center; gap: 8px;">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                  </svg>
                  Add Address
                </button>
              </div>
            </div>
            
            <div class="form-section">
              <h3>Order Summary</h3>
              <div id="addressSelectionOrderSummary" class="checkout-order-summary">
                <!-- Order items will be populated here -->
              </div>
              <div class="checkout-total">
                <div class="total-row">
                  <span>Subtotal</span>
                  <span id="addressSelectionSubtotal">â‚¹0.00</span>
                </div>
                <div class="total-row">
                  <span>Delivery Charges</span>
                  <span id="addressSelectionDelivery">â‚¹50.00</span>
                </div>
                <div class="total-row total-final">
                  <span>Total</span>
                  <span id="addressSelectionTotal">â‚¹0.00</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Address Form (shown after login/signup) -->
          <div id="addressFormSection" class="checkout-form" style="display: none;">
            <div class="form-section">
              <h3>Delivery Address</h3>
              <div class="form-group">
                <label for="addressName">Name *</label>
                <input type="text" id="addressName" placeholder="Enter your name" required />
              </div>
              <div class="form-group">
                <label for="addressLocality">Locality *</label>
                <input type="text" id="addressLocality" placeholder="Enter locality" required />
              </div>
              <div class="form-group">
                <label for="addressNear">Near *</label>
                <input type="text" id="addressNear" placeholder="Landmark or nearby place" required />
              </div>
              <div class="form-row">
                <div class="form-group">
                  <label for="addressCity">City *</label>
                  <input type="text" id="addressCity" placeholder="Enter city" required />
                </div>
                <div class="form-group">
                  <label for="addressState">State *</label>
                  <input type="text" id="addressState" placeholder="Enter state" required />
                </div>
              </div>
              <div class="form-group">
                <label for="addressPincode">Pincode *</label>
                <input type="text" id="addressPincode" placeholder="Enter pincode" required pattern="[0-9]{6}" maxlength="6" />
              </div>
              <div class="form-group">
                <label for="addressContact">Contact Number *</label>
                <input type="tel" id="addressContact" placeholder="Enter contact number" required />
              </div>
              <div class="form-group">
                <label class="checkbox-label" style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                  <input type="checkbox" id="addressSetAsDefault" style="width: auto; margin: 0;" />
                  <span>Add as default</span>
                </label>
              </div>
            </div>

            <div class="form-section">
              <h3>Order Summary</h3>
              <div id="addressOrderSummary" class="checkout-order-summary">
                <!-- Order items will be populated here -->
              </div>
              <div class="checkout-total">
                <div class="total-row">
                  <span>Subtotal</span>
                  <span id="addressSubtotal">â‚¹0.00</span>
                </div>
                <div class="total-row">
                  <span>Delivery Charges</span>
                  <span id="addressDelivery">â‚¹50.00</span>
                </div>
                <div class="total-row total-final">
                  <span>Total</span>
                  <span id="addressTotal">â‚¹0.00</span>
                </div>
              </div>
            </div>

            <div class="form-section" style="margin-top: 32px; padding-top: 24px; border-top: 2px solid var(--border); padding-bottom: 20px;">
              <button type="button" class="btn checkout-submit-btn" id="proceedToPaymentFromAddress" style="width: 100%; padding: 18px; font-size: 18px; font-weight: 700; background: var(--primary); color: #ffffff; border: none; border-radius: 12px; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);">
                <span style="display: flex; align-items: center; justify-content: center; gap: 8px;">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="display: inline-block;">
                    <path d="M5 12h14M12 5l7 7-7 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                  Payment Details
                </span>
              </button>
            </div>
          </div>
        </div>

        <!-- Payment Method Selection (hidden by default) -->
        <div id="paymentMethodSection" class="checkout-form" style="display: none;">
          <div class="form-section">
            <h3>Select Payment Method</h3>
            <div class="payment-methods-grid">
              <div class="payment-method-card" data-method="upi">
                <input type="radio" name="paymentMethod" id="paymentUPI" value="upi" required />
                <label for="paymentUPI" class="payment-method-label">
                  <div class="payment-method-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <rect x="2" y="6" width="20" height="12" rx="2" stroke="currentColor" stroke-width="2"/>
                      <path d="M2 10h20M8 14h8" stroke="currentColor" stroke-width="2"/>
                    </svg>
                  </div>
                  <div class="payment-method-info">
                    <div class="payment-method-name">UPI</div>
                    <div class="payment-method-desc">BHIM, PhonePe, Paytm, GooglePay</div>
                  </div>
                </label>
              </div>

              <div class="payment-method-card" data-method="debit">
                <input type="radio" name="paymentMethod" id="paymentDebit" value="debit" required />
                <label for="paymentDebit" class="payment-method-label">
                  <div class="payment-method-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <rect x="2" y="6" width="20" height="12" rx="2" stroke="currentColor" stroke-width="2"/>
                      <path d="M2 10h20" stroke="currentColor" stroke-width="2"/>
                    </svg>
                  </div>
                  <div class="payment-method-info">
                    <div class="payment-method-name">Debit Card</div>
                    <div class="payment-method-desc">Visa, Mastercard, Rupay</div>
                  </div>
                </label>
              </div>

              <div class="payment-method-card" data-method="credit">
                <input type="radio" name="paymentMethod" id="paymentCredit" value="credit" required />
                <label for="paymentCredit" class="payment-method-label">
                  <div class="payment-method-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <rect x="2" y="6" width="20" height="12" rx="2" stroke="currentColor" stroke-width="2"/>
                      <path d="M2 10h20" stroke="currentColor" stroke-width="2"/>
                    </svg>
                  </div>
                  <div class="payment-method-info">
                    <div class="payment-method-name">Credit Card</div>
                    <div class="payment-method-desc">Visa, Mastercard</div>
                  </div>
                </label>
              </div>

              <div class="payment-method-card" data-method="netbanking">
                <input type="radio" name="paymentMethod" id="paymentNetBanking" value="netbanking" required />
                <label for="paymentNetBanking" class="payment-method-label">
                  <div class="payment-method-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <rect x="3" y="4" width="18" height="16" rx="2" stroke="currentColor" stroke-width="2"/>
                      <path d="M3 10h18M8 14h8" stroke="currentColor" stroke-width="2"/>
                    </svg>
                  </div>
                  <div class="payment-method-info">
                    <div class="payment-method-name">Net Banking</div>
                    <div class="payment-method-desc">All major banks</div>
                  </div>
                </label>
              </div>

              <div class="payment-method-card" data-method="cod">
                <input type="radio" name="paymentMethod" id="paymentCOD" value="cod" required />
                <label for="paymentCOD" class="payment-method-label">
                  <div class="payment-method-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M12 2v20M2 12h20" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                      <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2"/>
                    </svg>
                  </div>
                  <div class="payment-method-info">
                    <div class="payment-method-name">Cash on Delivery</div>
                    <div class="payment-method-desc">Pay when you receive</div>
                  </div>
                </label>
              </div>

              <div class="payment-method-card" data-method="wallet">
                <input type="radio" name="paymentMethod" id="paymentWallet" value="wallet" required />
                <label for="paymentWallet" class="payment-method-label">
                  <div class="payment-method-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <rect x="2" y="6" width="20" height="12" rx="2" stroke="currentColor" stroke-width="2"/>
                      <path d="M2 10h20" stroke="currentColor" stroke-width="2"/>
                    </svg>
                  </div>
                  <div class="payment-method-info">
                    <div class="payment-method-name">HTH Wallet</div>
                    <div class="payment-method-desc">Use your HTH wallet balance</div>
                  </div>
                </label>
              </div>
            </div>
          </div>

          <div class="form-section">
            <h3>Order Summary</h3>
            <div id="paymentOrderSummary" class="checkout-order-summary">
              <!-- Order items will be populated here -->
            </div>
            <div class="checkout-total">
              <div class="total-row">
                <span>Subtotal</span>
                <span id="paymentSubtotal">â‚¹0.00</span>
              </div>
              <div class="total-row">
                <span>Delivery Charges</span>
                <span id="paymentDelivery">â‚¹50.00</span>
              </div>
              <div class="total-row total-final">
                <span>Total</span>
                <span id="paymentTotal">â‚¹0.00</span>
              </div>
            </div>
          </div>

          <button type="button" class="btn checkout-submit-btn" id="proceedToPaymentBtn">Proceed to Payment</button>
        </div>
      </div>
    </div>

    <!-- Mobile tab bar -->
    <nav class="mobile-tabbar" aria-label="Bottom navigation">
      <button id="tabHome" class="active" aria-label="Home">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M3 11l9-7 9 7v8a2 2 0 0 1-2 2h-4a2 2 0 0 1-2-2v-4H9v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-8z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        <span style="font-size:12px;">Home</span>
      </button>
      <button id="tabSearch" aria-label="Search">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M21 21l-3.8-3.8M10.5 18a7.5 7.5 0 100-15 7.5 7.5 0 000 15z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        <span style="font-size:12px;">Search</span>
      </button>
      <button id="tabProducts" aria-label="Products">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M3 7h18M3 12h18M3 17h18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        <span style="font-size:12px;">Products</span>
      </button>
      <button id="tabCart" class="mobile-badge" aria-label="Cart">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M3 3h2l1.5 12h11L21 6H6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><circle cx="9" cy="20" r="1.5" fill="currentColor"/><circle cx="17" cy="20" r="1.5" fill="currentColor"/></svg>
        <span id="cartCountMobile">0</span>
      </button>
      <button id="tabProfile" aria-label="Profile">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M12 12a5 5 0 100-10 5 5 0 000 10zM3 22a9 9 0 1118 0" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        <span style="font-size:12px;" id="tabProfileText">Login</span>
      </button>
    </nav>

    <!-- Favorites Modal -->
    <div id="favoritesModalOverlay" class="fullscreen-modal-overlay" aria-hidden="true">
      <div class="fullscreen-modal">
        <div class="fullscreen-modal-header">
          <h2>Your Favorites</h2>
          <button class="icon-btn" id="closeFavorites" aria-label="Close favorites">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
              <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
          </button>
        </div>
        <div class="fullscreen-modal-body" id="favoritesBody">
          <div class="muted" style="text-align:center; padding:40px;">Your favorites list is empty.</div>
        </div>
      </div>
    </div>

    <!-- Cart Modal -->
    <div id="cartModalOverlay" class="fullscreen-modal-overlay" aria-hidden="true">
      <div class="fullscreen-modal">
        <div class="fullscreen-modal-header">
          <h2>Your Cart</h2>
        <button class="icon-btn" id="closeCart" aria-label="Close cart">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </button>
      </div>
        <div class="fullscreen-modal-body" id="cartItems">
          <div class="muted" style="text-align:center; padding:40px;">Your cart is empty.</div>
      </div>
        <div class="fullscreen-modal-footer">
          <div style="display:flex; justify-content:space-between; margin-bottom:16px; padding:16px; background:var(--accent); border-radius:12px;">
            <div class="subtitle" style="font-size:18px;">Subtotal</div>
            <div id="subtotal" style="font-weight:700; font-size:20px;">â‚¹0.00</div>
        </div>
          <button class="btn primary" id="checkoutBtn" style="justify-content:center; width:100%; padding:16px; font-size:16px;">Checkout</button>
      </div>
      </div>
    </div>


    <script>
      const overlay = document.getElementById('overlay');
      const openCart = document.getElementById('openCart');
      const openFavorites = document.getElementById('openFavorites');
      const loginBtn = document.getElementById('loginBtn');
      const loginModalOverlay = document.getElementById('loginModalOverlay');
      const closeLoginModal = document.getElementById('closeLoginModal');
      const loginForm = document.getElementById('loginForm');
      const checkoutBtn = document.getElementById('checkoutBtn');
      const checkoutModalOverlay = document.getElementById('checkoutModalOverlay');
      const closeCheckoutModal = document.getElementById('closeCheckoutModal');
      const newCustomerBtn = document.getElementById('newCustomerBtn');
      const existingCustomerBtn = document.getElementById('existingCustomerBtn');
      const checkoutForm = document.getElementById('checkoutForm');
      const checkoutLoginForm = document.getElementById('checkoutLoginForm');
      const checkoutLoginSignupSection = document.getElementById('checkoutLoginSignupSection');
      const addressFormSection = document.getElementById('addressFormSection');
      const addressSelectionSection = document.getElementById('addressSelectionSection');
      const addressListContainer = document.getElementById('addressListContainer');
      const noAddressMessage = document.getElementById('noAddressMessage');
      const addNewAddressBtn = document.getElementById('addNewAddressBtn');
      const addFirstAddressBtn = document.getElementById('addFirstAddressBtn');
      const paymentMethodSection = document.getElementById('paymentMethodSection');
      const proceedToPaymentFromAddress = document.getElementById('proceedToPaymentFromAddress');
      const proceedToPaymentBtn = document.getElementById('proceedToPaymentBtn');
      const continueToAddressBtn = document.getElementById('continueToAddressBtn');
      const continueToAddressBtnLogin = document.getElementById('continueToAddressBtnLogin');
      const closeFavorites = document.getElementById('closeFavorites');
      const favoritesBody = document.getElementById('favoritesBody');
      const closeCart = document.getElementById('closeCart');
      const cartCount = document.getElementById('cartCount');
      const cartItems = document.getElementById('cartItems');
      const subtotal = document.getElementById('subtotal');
      const year = document.getElementById('year');
      const searchForm = document.getElementById('searchForm');
      const clearSearch = document.getElementById('clearSearch');
      const searchDropdown = document.getElementById('searchDropdown');
      const searchList = document.getElementById('searchList');
      const newsletterForm = document.getElementById('newsletterForm');
      const adsBottom = document.getElementById('adsBottom');
      const moreMenu = document.getElementById('moreMenu');
      const moreMenuBtn = document.getElementById('moreMenuBtn');
      const toaster = document.getElementById('toaster');
      const productModalOverlay = document.getElementById('productModalOverlay');
      const headerNavButtons = document.getElementById('headerNavButtons');
      const headerBackBtn = document.getElementById('headerBackBtn');
      const productModalImage = document.getElementById('productModalImage');
      const productModalTitle = document.getElementById('productModalTitle');
      const productModalSubtitle = document.getElementById('productModalSubtitle');
      const productModalPrice = document.getElementById('productModalPrice');
      const productModalDelivery = document.getElementById('productModalDelivery');
      const productModalOffers = document.getElementById('productModalOffers');
      const productModalDescription = document.getElementById('productModalDescription');
      const productSuggestions = document.getElementById('productSuggestions');
      const productQueryForm = document.getElementById('productQueryForm');
      const productQueryInput = document.getElementById('productQueryInput');
      const modalAddToCartBtn = document.getElementById('modalAddToCartBtn');
      const modalBuyNowBtn = document.getElementById('modalBuyNowBtn');
      const phoneOverlay = document.getElementById('phoneOverlay');
      const openPhoneView = document.getElementById('openPhoneView');
      const closePhoneView = document.getElementById('closePhoneView');
      const phoneIframe = document.getElementById('phoneIframe');
      const promoTrack = document.getElementById('promoTrack');
      const productsGrid = document.getElementById('productsGrid');
      const productCountEl = document.getElementById('productCount');

      year.textContent = new Date().getFullYear();

      // Dynamic data state
      let allProducts = [];
      let categoriesFromData = [];
      let activeProductId = null;

      function renderAds(trackEl) {
        if (!trackEl) return;
        const palette = [
          'linear-gradient(135deg, rgba(91,124,250,0.18), rgba(255,255,255,0.6))',
          'linear-gradient(135deg, rgba(16,185,129,0.18), rgba(255,255,255,0.6))',
          'linear-gradient(135deg, rgba(245,158,11,0.22), rgba(255,255,255,0.6))',
          'linear-gradient(135deg, rgba(236,72,153,0.18), rgba(255,255,255,0.6))',
          'linear-gradient(135deg, rgba(99,102,241,0.22), rgba(255,255,255,0.6))'
        ];
        const items = categoriesFromData.map((it, idx) => `
          <button class="ad-item" data-category="${it.key}" style="background:${palette[idx % palette.length]}; cursor:pointer; border:none;">
            <span class="label">${it.label}</span>
          </button>
        `).join('');
        // Duplicate content to create seamless loop
        trackEl.innerHTML = items + items;
        // Wire click -> filter by category
        trackEl.querySelectorAll('[data-category]').forEach(btn => {
          btn.addEventListener('click', () => {
            const cat = btn.getAttribute('data-category');
            // Check the corresponding filter and uncheck others
            document.querySelectorAll('.filters input[type="checkbox"]').forEach(cb => {
              cb.checked = cb.value === cat;
            });
            applyFilters();
            // Scroll products into view
            document.getElementById('products')?.scrollIntoView({ behavior: 'smooth' });
          });
        });
      }

      function getProductDetailData(product) {
        return {
          delivery: 'Ships in 4-6 days â€¢ â‚¹49 standard shipping (free over â‚¹999)',
          offers: [
            'Use code SHILPA5 for extra 5% off (min â‚¹499)',
            'Get complimentary gift wrap on prepaid orders'
          ],
          coupon: 'DEMO10 - Flat 10% off on orders above â‚¹1,499',
          description: `${product.title} is crafted thoughtfully using premium materials. Each piece from Hands to Heaven is finished by hand, making it a one-of-a-kind keepsake perfect for gifting or personal collections.`
        };
      }

      // Will render once data is loaded

      // Dropdown interactions (robust toggle + explicit close)
      function setMoreMenuOpen(open) {
        moreMenu.setAttribute('data-open', String(!!open));
        moreMenuBtn.setAttribute('aria-expanded', String(!!open));
      }
      moreMenuBtn?.addEventListener('click', (e) => {
        e.stopPropagation();
        const current = moreMenu.getAttribute('data-open') === 'true';
        setMoreMenuOpen(!current);
      });
      document.addEventListener('click', (e) => {
        if (!moreMenu.contains(e.target)) setMoreMenuOpen(false);
      });
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') setMoreMenuOpen(false);
      });
      // Close dropdown when interacting with search
      searchForm?.addEventListener('focusin', () => setMoreMenuOpen(false));

      // Track active modal for navigation
      let activeModal = null;

      function showHeaderNavButtons() {
        if (headerNavButtons) headerNavButtons.classList.add('active');
      }

      function hideHeaderNavButtons() {
        if (headerNavButtons) headerNavButtons.classList.remove('active');
      }

      function openCartModal() {
        if (cartModalOverlay) {
          cartModalOverlay.classList.add('active');
          cartModalOverlay.setAttribute('aria-hidden', 'false');
          document.body.style.overflow = 'hidden';
          renderCart();
          activeModal = 'cart';
          showHeaderNavButtons();
        }
      }

      function closeCartModal() {
        if (cartModalOverlay) {
          cartModalOverlay.classList.remove('active');
          cartModalOverlay.setAttribute('aria-hidden', 'true');
          document.body.style.overflow = '';
          activeModal = null;
          hideHeaderNavButtons();
        }
      }

      function openFavoritesModal() {
        if (favoritesModalOverlay) {
          favoritesModalOverlay.classList.add('active');
          favoritesModalOverlay.setAttribute('aria-hidden', 'false');
          document.body.style.overflow = 'hidden';
          renderFavorites();
          activeModal = 'favorites';
          showHeaderNavButtons();
        }
      }

      function closeFavoritesModal() {
        if (favoritesModalOverlay) {
          favoritesModalOverlay.classList.remove('active');
          favoritesModalOverlay.setAttribute('aria-hidden', 'true');
          document.body.style.overflow = '';
          activeModal = null;
          hideHeaderNavButtons();
        }
      }

      openCart?.addEventListener('click', openCartModal);
      closeCart?.addEventListener('click', closeCartModal);
      openFavorites?.addEventListener('click', openFavoritesModal);
      closeFavorites?.addEventListener('click', closeFavoritesModal);
      
      cartModalOverlay?.addEventListener('click', (e) => {
        if (e.target === cartModalOverlay) closeCartModal();
      });
      favoritesModalOverlay?.addEventListener('click', (e) => {
        if (e.target === favoritesModalOverlay) closeFavoritesModal();
      });
      
      function openLoginModal() {
        if (loginModalOverlay) {
          loginModalOverlay.classList.add('active');
          loginModalOverlay.setAttribute('aria-hidden', 'false');
          document.body.style.overflow = 'hidden';
          activeModal = 'login';
          showHeaderNavButtons();
        }
      }

      function closeLoginModalFunc() {
        if (loginModalOverlay) {
          loginModalOverlay.classList.remove('active');
          loginModalOverlay.setAttribute('aria-hidden', 'true');
          document.body.style.overflow = '';
          activeModal = null;
          hideHeaderNavButtons();
        }
      }

      // User Database Functions (using localStorage)
      function getUserDatabase() {
        const db = localStorage.getItem('userDatabase');
        return db ? JSON.parse(db) : {};
      }

      function saveUserDatabase(database) {
        localStorage.setItem('userDatabase', JSON.stringify(database));
      }

      function getCurrentUser() {
        const user = localStorage.getItem('currentUser');
        return user ? JSON.parse(user) : null;
      }

      function setCurrentUser(user) {
        if (user) {
          localStorage.setItem('currentUser', JSON.stringify(user));
        } else {
          localStorage.removeItem('currentUser');
        }
        updateLoginButton();
      }

      function updateLoginButton() {
        const currentUser = getCurrentUser();
        const tabProfileText = document.getElementById('tabProfileText');
        const tabProfile = document.getElementById('tabProfile');
        
        if (currentUser && loginBtn) {
          loginBtn.innerHTML = `
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
              <path d="M12 12a5 5 0 100-10 5 5 0 000 10zM3 22a9 9 0 1118 0" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
            <span>${currentUser.name.split(' ')[0]}</span>
          `;
          loginBtn.setAttribute('aria-label', 'View Profile');
          if (tabProfileText) tabProfileText.textContent = currentUser.name.split(' ')[0];
          if (tabProfile) tabProfile.setAttribute('aria-label', 'View Profile');
        } else if (loginBtn) {
          loginBtn.innerHTML = `
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
              <path d="M12 12a5 5 0 100-10 5 5 0 000 10zM3 22a9 9 0 1118 0" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
            <span>Login</span>
          `;
          loginBtn.setAttribute('aria-label', 'Login');
          if (tabProfileText) tabProfileText.textContent = 'Login';
          if (tabProfile) tabProfile.setAttribute('aria-label', 'Login');
        }
      }

      function renderUserProfile() {
        const currentUser = getCurrentUser();
        if (!currentUser || !userProfileContent) return;
        
        userProfileContent.innerHTML = `
          <div class="profile-field">
            <div class="profile-field-label">Full Name</div>
            <div class="profile-field-value">${currentUser.name}</div>
          </div>
          <div class="profile-field">
            <div class="profile-field-label">Email Address</div>
            <div class="profile-field-value">${currentUser.email}</div>
          </div>
          <div class="profile-field">
            <div class="profile-field-label">Phone Number</div>
            <div class="profile-field-value">${currentUser.phone}</div>
          </div>
          <div class="profile-field">
            <div class="profile-field-label">Address</div>
            <div class="profile-field-value">${currentUser.address}</div>
          </div>
          <div class="profile-field">
            <div class="profile-field-label">City</div>
            <div class="profile-field-value">${currentUser.city}</div>
          </div>
          <div class="profile-field">
            <div class="profile-field-label">State</div>
            <div class="profile-field-value">${currentUser.state}</div>
          </div>
          <div class="profile-field">
            <div class="profile-field-label">Pincode</div>
            <div class="profile-field-value">${currentUser.pincode}</div>
          </div>
        `;
      }

      function openUserProfile() {
        if (userProfileModalOverlay) {
          renderUserProfile();
          userProfileModalOverlay.classList.add('active');
          userProfileModalOverlay.setAttribute('aria-hidden', 'false');
          document.body.style.overflow = 'hidden';
          activeModal = 'profile';
          showHeaderNavButtons();
        }
      }

      function closeUserProfileModalFunc() {
        if (userProfileModalOverlay) {
          userProfileModalOverlay.classList.remove('active');
          userProfileModalOverlay.setAttribute('aria-hidden', 'true');
          document.body.style.overflow = '';
          activeModal = null;
          hideHeaderNavButtons();
        }
      }

      // Toggle between login and signup forms
      createAccountLink?.addEventListener('click', (e) => {
        e.preventDefault();
        if (loginContainer && signupContainer) {
          loginContainer.style.display = 'none';
          signupContainer.style.display = 'block';
        }
      });

      backToLoginLink?.addEventListener('click', (e) => {
        e.preventDefault();
        if (loginContainer && signupContainer) {
          signupContainer.style.display = 'none';
          loginContainer.style.display = 'block';
          // Clear signup form
          if (signupForm) signupForm.reset();
          const passwordMatchError = document.getElementById('passwordMatchError');
          if (passwordMatchError) passwordMatchError.classList.remove('show');
        }
      });

      // Signup form submission
      signupForm?.addEventListener('submit', (e) => {
        e.preventDefault();
        const name = document.getElementById('signupName')?.value.trim();
        const email = document.getElementById('signupEmail')?.value.trim().toLowerCase();
        const phone = document.getElementById('signupPhone')?.value.trim();
        const password = document.getElementById('signupPassword')?.value;
        const confirmPassword = document.getElementById('signupConfirmPassword')?.value;
        const privacyPolicy = document.getElementById('signupPrivacyPolicy')?.checked;

        const passwordMatchError = document.getElementById('passwordMatchError');
        
        // Validate password match
        if (password !== confirmPassword) {
          if (passwordMatchError) passwordMatchError.classList.add('show');
          showToast('Passwords do not match. Please try again.');
          return;
        }
        
        if (passwordMatchError) passwordMatchError.classList.remove('show');

        if (!privacyPolicy) {
          showToast('Please accept the Privacy Policy to continue.');
          return;
        }

        // Check if email already exists
        const database = getUserDatabase();
        if (database[email]) {
          showToast('An account with this email already exists. Please login instead.');
          return;
        }

        // Create user object
        const user = {
          name,
          email,
          phone,
          address: '',
          city: '',
          state: '',
          pincode: '',
          password: btoa(password) // Simple encoding (not secure, but works for demo)
        };

        // Save to database
        database[email] = user;
        saveUserDatabase(database);

        // Auto login after signup
        setCurrentUser(user);
        showToast('Account created successfully! Welcome to Hands to Heaven.');
        signupForm.reset();
        if (loginContainer && signupContainer) {
          signupContainer.style.display = 'none';
          loginContainer.style.display = 'block';
        }
        
        // Check if there's a pending checkout action (from Buy Now button)
        const pendingCheckout = localStorage.getItem('pendingCheckout');
        if (pendingCheckout === 'true') {
          localStorage.removeItem('pendingCheckout');
          closeLoginModalFunc();
          setTimeout(() => openCheckoutModal(), 300);
        } else {
          closeLoginModalFunc();
        }
      });

      // Password match validation on input
      const signupConfirmPassword = document.getElementById('signupConfirmPassword');
      const signupPassword = document.getElementById('signupPassword');
      const passwordMatchError = document.getElementById('passwordMatchError');
      
      signupConfirmPassword?.addEventListener('input', () => {
        if (signupPassword?.value && signupConfirmPassword?.value) {
          if (signupPassword.value !== signupConfirmPassword.value) {
            if (passwordMatchError) passwordMatchError.classList.add('show');
          } else {
            if (passwordMatchError) passwordMatchError.classList.remove('show');
          }
        }
      });

      signupPassword?.addEventListener('input', () => {
        if (signupPassword.value && signupConfirmPassword?.value) {
          if (signupPassword.value !== signupConfirmPassword.value) {
            if (passwordMatchError) passwordMatchError.classList.add('show');
          } else {
            if (passwordMatchError) passwordMatchError.classList.remove('show');
          }
        }
      });

      // Login form submission
      loginBtn?.addEventListener('click', (e) => {
        e.preventDefault();
        const currentUser = getCurrentUser();
        if (currentUser) {
          openUserProfile();
        } else {
          openLoginModal();
        }
      });

      closeLoginModal?.addEventListener('click', closeLoginModalFunc);
      loginModalOverlay?.addEventListener('click', (e) => {
        if (e.target === loginModalOverlay) closeLoginModalFunc();
      });
      
      loginForm?.addEventListener('submit', (e) => {
        e.preventDefault();
        const email = document.getElementById('loginEmail')?.value.trim().toLowerCase();
        const password = document.getElementById('loginPassword')?.value;
        
        if (!email || !password) {
          showToast('Please enter both email and password.');
          return;
        }

        const database = getUserDatabase();
        const user = database[email];

        if (!user) {
          showToast('No account found with this email. Please sign up first.');
          return;
        }

        // Check password (decode and compare)
        if (btoa(password) !== user.password) {
          showToast('Incorrect password. Please try again.');
          return;
        }

        // Login successful
        setCurrentUser(user);
        showToast('Login successful! Welcome back.');
        loginForm.reset();
        
        // Check if there's a pending checkout action (from Buy Now button)
        const pendingCheckout = localStorage.getItem('pendingCheckout');
        if (pendingCheckout === 'true') {
          localStorage.removeItem('pendingCheckout');
          closeLoginModalFunc();
          setTimeout(() => openCheckoutModal(), 300);
        } else {
          closeLoginModalFunc();
        }
      });
      
      document.getElementById('forgotPasswordLink')?.addEventListener('click', (e) => {
        e.preventDefault();
        showToast('Password reset link will be sent to your email.');
      });

      // User Profile Modal
      closeUserProfileModal?.addEventListener('click', closeUserProfileModalFunc);
      userProfileModalOverlay?.addEventListener('click', (e) => {
        if (e.target === userProfileModalOverlay) closeUserProfileModalFunc();
      });

      logoutBtn?.addEventListener('click', () => {
        setCurrentUser(null);
        showToast('Logged out successfully.');
        closeUserProfileModalFunc();
      });

      // Initialize login button on page load
      updateLoginButton();
      
      // Checkout Modal Functions
      function openCheckoutModal() {
        if (checkoutModalOverlay && cart.items.length > 0) {
          checkoutModalOverlay.classList.add('active');
          checkoutModalOverlay.setAttribute('aria-hidden', 'false');
          document.body.style.overflow = 'hidden';
          renderCheckoutOrderSummary();
          
          const currentUser = getCurrentUser();
          
          // If user is already logged in, show address form directly
          if (currentUser) {
            checkoutLoginSignupSection.style.display = 'none';
            addressFormSection.style.display = 'flex';
            paymentMethodSection.style.display = 'none';
            renderAddressOrderSummary();
            // Pre-fill name and contact from user profile if available
            if (currentUser.name) {
              const addressNameInput = document.getElementById('addressName');
              if (addressNameInput) addressNameInput.value = currentUser.name;
            }
            if (currentUser.phone) {
              const addressContactInput = document.getElementById('addressContact');
              if (addressContactInput) addressContactInput.value = currentUser.phone;
            }
          } else {
            // Show login/signup forms
            checkoutLoginSignupSection.style.display = 'block';
            addressFormSection.style.display = 'none';
            paymentMethodSection.style.display = 'none';
            newCustomerBtn?.classList.add('active');
            existingCustomerBtn?.classList.remove('active');
            checkoutForm.style.display = 'flex';
            checkoutLoginForm.style.display = 'none';
          }
          
          activeModal = 'checkout';
          showHeaderNavButtons();
        } else if (cart.items.length === 0) {
          showToast('Your cart is empty. Add items to checkout.');
        }
      }
      
      function renderContinueOrderSummary() {
        const continueOrderSummary = document.getElementById('continueOrderSummary');
        const continueSubtotal = document.getElementById('continueSubtotal');
        const continueTotal = document.getElementById('continueTotal');
        const deliveryCharges = 50;
        
        if (!continueOrderSummary || cart.items.length === 0) return;
        
        const subtotalAmount = cart.total;
        const totalAmount = subtotalAmount + deliveryCharges;
        
        const orderItemsHTML = cart.items.map(item => `
          <div class="checkout-order-item">
            <img src="${item.image || 'products/couple ring.jpg'}" alt="${item.title}" onerror="this.src='products/couple ring.jpg'">
            <div class="checkout-order-item-details">
              <div class="item-name">${item.title}</div>
              <div class="item-price">â‚¹${item.price}</div>
              <div class="item-quantity">Quantity: ${item.quantity || 1}</div>
            </div>
          </div>
        `).join('');
        
        continueOrderSummary.innerHTML = orderItemsHTML;
        
        if (continueSubtotal) continueSubtotal.textContent = `â‚¹${subtotalAmount.toFixed(2)}`;
        if (continueTotal) continueTotal.textContent = `â‚¹${totalAmount.toFixed(2)}`;
      }
      
      function renderContinueOrderSummaryLogin() {
        const continueOrderSummaryLogin = document.getElementById('continueOrderSummaryLogin');
        const continueSubtotalLogin = document.getElementById('continueSubtotalLogin');
        const continueTotalLogin = document.getElementById('continueTotalLogin');
        const deliveryCharges = 50;
        
        if (!continueOrderSummaryLogin || cart.items.length === 0) return;
        
        const subtotalAmount = cart.total;
        const totalAmount = subtotalAmount + deliveryCharges;
        
        const orderItemsHTML = cart.items.map(item => `
          <div class="checkout-order-item">
            <img src="${item.image || 'products/couple ring.jpg'}" alt="${item.title}" onerror="this.src='products/couple ring.jpg'">
            <div class="checkout-order-item-details">
              <div class="item-name">${item.title}</div>
              <div class="item-price">â‚¹${item.price}</div>
              <div class="item-quantity">Quantity: ${item.quantity || 1}</div>
            </div>
          </div>
        `).join('');
        
        continueOrderSummaryLogin.innerHTML = orderItemsHTML;
        
        if (continueSubtotalLogin) continueSubtotalLogin.textContent = `â‚¹${subtotalAmount.toFixed(2)}`;
        if (continueTotalLogin) continueTotalLogin.textContent = `â‚¹${totalAmount.toFixed(2)}`;
      }
      
      function showAddressFormSection() {
        checkoutLoginSignupSection.style.display = 'none';
        addressFormSection.style.display = 'flex';
        paymentMethodSection.style.display = 'none';
        renderAddressOrderSummary();
      }
      
      function renderPaymentOrderSummary() {
        const paymentOrderSummary = document.getElementById('paymentOrderSummary');
        const paymentSubtotal = document.getElementById('paymentSubtotal');
        const paymentTotal = document.getElementById('paymentTotal');
        const deliveryCharges = 50;
        
        if (!paymentOrderSummary || cart.items.length === 0) return;
        
        const subtotalAmount = cart.total;
        const totalAmount = subtotalAmount + deliveryCharges;
        
        const orderItemsHTML = cart.items.map(item => `
          <div class="checkout-order-item">
            <img src="${item.image || 'products/couple ring.jpg'}" alt="${item.title}" onerror="this.src='products/couple ring.jpg'">
            <div class="checkout-order-item-details">
              <div class="item-name">${item.title}</div>
              <div class="item-price">â‚¹${item.price}</div>
              <div class="item-quantity">Quantity: ${item.quantity || 1}</div>
            </div>
          </div>
        `).join('');
        
        paymentOrderSummary.innerHTML = orderItemsHTML;
        
        if (paymentSubtotal) paymentSubtotal.textContent = `â‚¹${subtotalAmount.toFixed(2)}`;
        if (paymentTotal) paymentTotal.textContent = `â‚¹${totalAmount.toFixed(2)}`;
      }
      
      function renderAddressOrderSummary() {
        const addressOrderSummary = document.getElementById('addressOrderSummary');
        const addressSubtotal = document.getElementById('addressSubtotal');
        const addressTotal = document.getElementById('addressTotal');
        const deliveryCharges = 50;
        
        if (!addressOrderSummary || cart.items.length === 0) return;
        
        const subtotalAmount = cart.total;
        const totalAmount = subtotalAmount + deliveryCharges;
        
        const orderItemsHTML = cart.items.map(item => `
          <div class="checkout-order-item">
            <img src="${item.image || 'products/couple ring.jpg'}" alt="${item.title}" onerror="this.src='products/couple ring.jpg'">
            <div class="checkout-order-item-details">
              <div class="item-name">${item.title}</div>
              <div class="item-price">â‚¹${item.price}</div>
              <div class="item-quantity">Quantity: ${item.quantity || 1}</div>
            </div>
          </div>
        `).join('');
        
        addressOrderSummary.innerHTML = orderItemsHTML;
        
        if (addressSubtotal) addressSubtotal.textContent = `â‚¹${subtotalAmount.toFixed(2)}`;
        if (addressTotal) addressTotal.textContent = `â‚¹${totalAmount.toFixed(2)}`;
      }
      
      function showAddressFormSection() {
        checkoutLoginSignupSection.style.display = 'none';
        addressFormSection.style.display = 'flex';
        paymentMethodSection.style.display = 'none';
        renderAddressOrderSummary();
      }
      
      function showPaymentMethodSection() {
        checkoutLoginSignupSection.style.display = 'none';
        addressFormSection.style.display = 'none';
        paymentMethodSection.style.display = 'flex';
        renderPaymentOrderSummary();
      }

      function closeCheckoutModalFunc() {
        if (checkoutModalOverlay) {
          checkoutModalOverlay.classList.remove('active');
          checkoutModalOverlay.setAttribute('aria-hidden', 'true');
          document.body.style.overflow = '';
          activeModal = null;
          hideHeaderNavButtons();
        }
      }

      function renderCheckoutOrderSummary() {
        const checkoutOrderSummary = document.getElementById('checkoutOrderSummary');
        const checkoutLoginOrderSummary = document.getElementById('checkoutLoginOrderSummary');
        const checkoutSubtotal = document.getElementById('checkoutSubtotal');
        const checkoutLoginSubtotal = document.getElementById('checkoutLoginSubtotal');
        const checkoutTotal = document.getElementById('checkoutTotal');
        const checkoutLoginTotal = document.getElementById('checkoutLoginTotal');
        const deliveryCharges = 50;
        
        if (!checkoutOrderSummary || cart.items.length === 0) return;
        
        const subtotalAmount = cart.total;
        const totalAmount = subtotalAmount + deliveryCharges;
        
        const orderItemsHTML = cart.items.map(item => `
          <div class="checkout-order-item">
            <img src="${item.image || 'products/couple ring.jpg'}" alt="${item.title}" onerror="this.src='products/couple ring.jpg'">
            <div class="checkout-order-item-details">
              <div class="item-name">${item.title}</div>
              <div class="item-price">â‚¹${item.price}</div>
              <div class="item-quantity">Quantity: ${item.quantity || 1}</div>
            </div>
          </div>
        `).join('');
        
        checkoutOrderSummary.innerHTML = orderItemsHTML;
        if (checkoutLoginOrderSummary) {
          checkoutLoginOrderSummary.innerHTML = orderItemsHTML;
        }
        
        if (checkoutSubtotal) checkoutSubtotal.textContent = `â‚¹${subtotalAmount.toFixed(2)}`;
        if (checkoutLoginSubtotal) checkoutLoginSubtotal.textContent = `â‚¹${subtotalAmount.toFixed(2)}`;
        if (checkoutTotal) checkoutTotal.textContent = `â‚¹${totalAmount.toFixed(2)}`;
        if (checkoutLoginTotal) checkoutLoginTotal.textContent = `â‚¹${totalAmount.toFixed(2)}`;
      }

      checkoutBtn?.addEventListener('click', (e) => {
        e.preventDefault();
        closeCartModal();
        setTimeout(() => openCheckoutModal(), 300);
      });

      closeCheckoutModal?.addEventListener('click', closeCheckoutModalFunc);
      checkoutModalOverlay?.addEventListener('click', (e) => {
        if (e.target === checkoutModalOverlay) closeCheckoutModalFunc();
      });

      // Toggle between new customer and existing customer forms
      newCustomerBtn?.addEventListener('click', () => {
        newCustomerBtn.classList.add('active');
        existingCustomerBtn?.classList.remove('active');
        checkoutForm.style.display = 'flex';
        checkoutLoginForm.style.display = 'none';
      });

      existingCustomerBtn?.addEventListener('click', () => {
        existingCustomerBtn.classList.add('active');
        newCustomerBtn?.classList.remove('active');
        checkoutForm.style.display = 'none';
        checkoutLoginForm.style.display = 'flex';
        renderCheckoutOrderSummary();
      });

      // Password match validation for checkout signup
      const checkoutSignupPassword = document.getElementById('checkoutSignupPassword');
      const checkoutSignupConfirmPassword = document.getElementById('checkoutSignupConfirmPassword');
      const checkoutPasswordMatchError = document.getElementById('checkoutPasswordMatchError');
      
      checkoutSignupConfirmPassword?.addEventListener('input', () => {
        if (checkoutSignupPassword?.value && checkoutSignupConfirmPassword?.value) {
          if (checkoutSignupPassword.value !== checkoutSignupConfirmPassword.value) {
            if (checkoutPasswordMatchError) checkoutPasswordMatchError.classList.add('show');
          } else {
            if (checkoutPasswordMatchError) checkoutPasswordMatchError.classList.remove('show');
          }
        }
      });

      checkoutSignupPassword?.addEventListener('input', () => {
        if (checkoutSignupPassword.value && checkoutSignupConfirmPassword?.value) {
          if (checkoutSignupPassword.value !== checkoutSignupConfirmPassword.value) {
            if (checkoutPasswordMatchError) checkoutPasswordMatchError.classList.add('show');
          } else {
            if (checkoutPasswordMatchError) checkoutPasswordMatchError.classList.remove('show');
          }
        }
      });

      // Handle checkout signup form submission (new customer)
      checkoutForm?.addEventListener('submit', (e) => {
        e.preventDefault();
        const email = document.getElementById('checkoutSignupEmail')?.value.trim().toLowerCase();
        const password = document.getElementById('checkoutSignupPassword')?.value;
        const confirmPassword = document.getElementById('checkoutSignupConfirmPassword')?.value;
        
        const passwordMatchError = document.getElementById('checkoutPasswordMatchError');
        
        // Validate password match
        if (password !== confirmPassword) {
          if (passwordMatchError) passwordMatchError.classList.add('show');
          showToast('Passwords do not match. Please try again.');
          return;
        }
        
        if (passwordMatchError) passwordMatchError.classList.remove('show');

        // Check if email already exists
        const database = getUserDatabase();
        if (database[email]) {
          showToast('An account with this email already exists. Please login instead.');
          return;
        }

        // Create user object (minimal for checkout)
        const user = {
          name: '', // Will be filled in address form
          email: email,
          phone: '', // Will be filled in address form
          address: '',
          city: '',
          state: '',
          pincode: '',
          password: btoa(password)
        };

        // Save to database
        database[email] = user;
        saveUserDatabase(database);

        // Auto login after signup
        setCurrentUser(user);
        showToast('Account created successfully!');
        
        // Hide signup form and show continue button
        checkoutForm.style.display = 'none';
        const continueSection = document.getElementById('continueToAddressSection');
        if (continueSection) {
          continueSection.style.display = 'flex';
          renderContinueOrderSummary();
          // Scroll to top to show the button
          continueSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
      });

      // Handle checkout login form submission
      checkoutLoginForm?.addEventListener('submit', (e) => {
        e.preventDefault();
        const email = document.getElementById('checkoutLoginEmail')?.value.trim().toLowerCase();
        const password = document.getElementById('checkoutLoginPassword')?.value;
        
        if (!email || !password) {
          showToast('Please enter both email and password.');
          return;
        }

        const database = getUserDatabase();
        const user = database[email];

        if (!user) {
          showToast('No account found with this email. Please sign up first.');
          return;
        }

        // Check password
        if (btoa(password) !== user.password) {
          showToast('Incorrect password. Please try again.');
          return;
        }

        // Login successful - set current user
        setCurrentUser(user);
        showToast('Login successful!');
        
        // Hide login form and show continue button
        checkoutLoginForm.style.display = 'none';
        const continueSectionLogin = document.getElementById('continueToAddressSectionLogin');
        if (continueSectionLogin) {
          continueSectionLogin.style.display = 'flex';
          renderContinueOrderSummaryLogin();
          // Scroll to top to show the button
          continueSectionLogin.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
      });
      
      // Handle continue to address button clicks
      continueToAddressBtn?.addEventListener('click', () => {
        document.getElementById('continueToAddressSection').style.display = 'none';
        showAddressFormSection();
      });
      
      continueToAddressBtnLogin?.addEventListener('click', () => {
        document.getElementById('continueToAddressSectionLogin').style.display = 'none';
        showAddressFormSection();
      });
      
      // Handle address form submission
      proceedToPaymentFromAddress?.addEventListener('click', () => {
        const name = document.getElementById('addressName')?.value.trim();
        const locality = document.getElementById('addressLocality')?.value.trim();
        const near = document.getElementById('addressNear')?.value.trim();
        const city = document.getElementById('addressCity')?.value.trim();
        const state = document.getElementById('addressState')?.value.trim();
        const pincode = document.getElementById('addressPincode')?.value.trim();
        const contact = document.getElementById('addressContact')?.value.trim();
        const setAsDefault = document.getElementById('addressSetAsDefault')?.checked;
        
        if (!name || !locality || !near || !city || !state || !pincode || !contact) {
          showToast('Please fill all required address fields.');
          return;
        }
        
        const addressData = {
          name,
          locality,
          near,
          city,
          state,
          pincode,
          contact,
          setAsDefault
        };
        
        // Save address to saved addresses list
        saveAddress(addressData);
        
        // Save address data for checkout
        localStorage.setItem('checkoutAddressData', JSON.stringify(addressData));
        
        // If set as default, update user profile
        const currentUser = getCurrentUser();
        if (currentUser && setAsDefault) {
          currentUser.name = name;
          currentUser.phone = contact;
          currentUser.address = `${locality}, Near ${near}`;
          currentUser.city = city;
          currentUser.state = state;
          currentUser.pincode = pincode;
          setCurrentUser(currentUser);
          
          // Update in database
          const database = getUserDatabase();
          database[currentUser.email] = currentUser;
          saveUserDatabase(database);
        }
        
        // Show payment method selection
        showPaymentMethodSection();
      });
      
      // Handle payment method selection and proceed to payment
      proceedToPaymentBtn?.addEventListener('click', () => {
        const selectedPayment = document.querySelector('input[name="paymentMethod"]:checked');
        
        if (!selectedPayment) {
          showToast('Please select a payment method.');
          return;
        }
        
        const paymentMethod = selectedPayment.value;
        const currentUser = getCurrentUser();
        const customerData = localStorage.getItem('checkoutCustomerData');
        
        const addressData = localStorage.getItem('checkoutAddressData');
        
        const orderData = {
          paymentMethod: paymentMethod,
          items: cart.items,
          total: cart.total + 50,
          user: currentUser || null,
          address: addressData ? JSON.parse(addressData) : null
        };
        
        // Here you would typically send this to your backend for payment processing
        console.log('Order data with payment method:', orderData);
        
        // Simulate payment processing
        showToast(`Processing payment via ${paymentMethod.toUpperCase()}...`);
        
        // After successful payment (simulated)
        setTimeout(() => {
          // Save address to user's saved addresses if not already saved
          if (addressData) {
            const parsedAddress = JSON.parse(addressData);
            const addresses = getSavedAddresses();
            const addressExists = addresses.some(addr => 
              addr.locality === parsedAddress.locality &&
              addr.city === parsedAddress.city &&
              addr.pincode === parsedAddress.pincode
            );
            if (!addressExists) {
              saveAddress(parsedAddress);
            }
          }
          
          showToast('Order placed successfully! Thank you for your purchase.');
          // Clear cart after successful order
          cart.items = [];
          cart.total = 0;
          localStorage.setItem('cart', JSON.stringify(cart));
          localStorage.removeItem('checkoutCustomerData');
          renderCart();
          closeCheckoutModalFunc();
        }, 2000);
      });

      document.getElementById('checkoutForgotPassword')?.addEventListener('click', (e) => {
        e.preventDefault();
        showToast('Password reset link will be sent to your email.');
      });

      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          closeCartModal();
          closeFavoritesModal();
          closeLoginModalFunc();
          closeCheckoutModalFunc();
          closeUserProfileModalFunc();
        }
      });
      
      function renderFavorites() {
        if (!favoritesBody) return;
        const favorites = getFavorites();
        if (favorites.length === 0) {
          favoritesBody.innerHTML = '<div class="muted" style="text-align:center; padding:40px;">Your favorites list is empty.</div>';
          return;
        }
        const favoriteProducts = allProducts.filter(p => favorites.includes(p.id));
        favoritesBody.innerHTML = `
          <div class="grid" style="grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 16px;">
            ${favoriteProducts.map(p => `
              <article class="card" data-id="${p.id}" style="position:relative;">
                <div class="media">
                  <img src="${p.image}" alt="${p.title}" />
                  <button class="favorite-btn active" data-product-id="${p.id}" aria-label="Remove from favorites" onclick="event.stopPropagation(); toggleFavorite('${p.id}');">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ef4444"/>
                    </svg>
                  </button>
                </div>
                <div class="info">
                  <div class="title">${p.title}</div>
                  <div class="subtitle">${p.subtitle}</div>
                  <div class="price-row-card">
                    <div>â‚¹${p.price}</div>
                    <button class="add-btn" onclick="event.stopPropagation(); addProductToCartData({title: '${p.title.replace(/'/g, "\\'")}', variant: '${p.subtitle.replace(/'/g, "\\'")}', price: ${p.price}}); renderCart(); showToast('Added to cart');">Add</button>
                  </div>
                </div>
              </article>
            `).join('')}
          </div>
        `;
        
        // Bind click events for product cards
        favoritesBody.querySelectorAll('.card[data-id]').forEach(card => {
          card.addEventListener('click', () => {
            const id = card.getAttribute('data-id');
            if (id) openProductModal(id);
          });
        });
      }

      // Diwali promo slider autoplay
      (function initPromoSlider() {
        if (!promoTrack) return;
        let index = 0;
        const slides = promoTrack.children.length;
        function go(n) {
          index = (n + slides) % slides;
          promoTrack.style.transform = `translateX(${-index * 100}vw)`;
        }
        setInterval(() => go(index + 1), 3500);
      })();

      // Demo cart state
      const cart = { items: [], total: 0 };
      // Clear any default cart items and start fresh
      try {
        localStorage.removeItem('cart');
      } catch {}
      
      // Favorites functionality
      function getFavorites() {
        try {
          const raw = localStorage.getItem('favorites');
          return raw ? JSON.parse(raw) : [];
        } catch {
          return [];
        }
      }
      
      function saveFavorites(favorites) {
        try {
          localStorage.setItem('favorites', JSON.stringify(favorites));
      } catch {}
      }
      
      function toggleFavorite(productId) {
        const favorites = getFavorites();
        const index = favorites.indexOf(productId);
        
        if (index > -1) {
          favorites.splice(index, 1);
          showToast('Removed from favorites');
        } else {
          favorites.push(productId);
          showToast('Added to favorites');
        }
        
        saveFavorites(favorites);
        updateFavoritesCount();
        updateFavoriteButtons();
        if (favoritesModalOverlay && favoritesModalOverlay.getAttribute('aria-hidden') === 'false') {
          renderFavorites();
        }
      }
      
      function updateFavoritesCount() {
        const favoritesCount = document.getElementById('favoritesCount');
        if (favoritesCount) {
          const count = getFavorites().length;
          favoritesCount.textContent = String(count);
          favoritesCount.style.display = count > 0 ? 'block' : 'none';
        }
      }
      
      function updateFavoriteButtons() {
        const favorites = getFavorites();
        document.querySelectorAll('.favorite-btn').forEach(btn => {
          const productId = btn.getAttribute('data-product-id');
          if (favorites.includes(productId)) {
            btn.classList.add('active');
          } else {
            btn.classList.remove('active');
          }
        });
      }
      
      // Make toggleFavorite available globally for onclick
      window.toggleFavorite = toggleFavorite;
      function showToast(message) {
        const el = document.createElement('div');
        el.className = 'toast enter';
        el.innerHTML = `<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="min-width:16px"><path d="M9 12l2 2 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg><span>${message}</span>`;
        toaster.appendChild(el);
        setTimeout(() => {
          el.classList.remove('enter');
          el.classList.add('exit');
          setTimeout(() => el.remove(), 200);
        }, 1600);
      }

      function addProductToCartData({ title, variant, price }) {
        const key = `${title}|${variant}|${price}`;
        const existing = cart.items.find(it => `${it.title}|${it.variant}|${it.price}` === key);
        if (existing) {
          existing.quantity += 1;
        } else {
          cart.items.push({ title, variant, price, quantity: 1 });
        }
        renderCart();
        try { localStorage.setItem('cart', JSON.stringify(cart)); } catch {}
        showToast(`${title} added to cart`);
        if (cartCount) {
          cartCount.style.animation = 'none';
          cartCount.offsetHeight;
          cartCount.style.animation = 'pulse 0.6s ease-out';
        }
      }
      function renderCart() {
        if (cart.items.length === 0) {
          cartItems.innerHTML = '<div class="muted" style="text-align:center; padding:40px;">Your cart is empty.</div>';
          subtotal.textContent = 'â‚¹0.00';
          cartCount.textContent = '0';
          cartCountMobile.textContent = '0';
          return;
        }
        let html = '';
        cart.total = 0;
        cart.items.forEach((it, idx) => {
          cart.total += it.price * it.quantity;
          html += `\n            <div style=\"display:flex; gap:12px; align-items:center; border-bottom:1px solid var(--border); padding:10px 0;\">\n              <div style=\"width:64px; height:64px; background:linear-gradient(135deg,#eef2ff,#f8fafc); border-radius:8px;\"></div>\n              <div style=\"flex:1;\">\n                <div class=\"title\">${it.title}</div>\n                <div class=\"muted\" style=\"font-size:14px;\">${it.variant}</div>\n                <div class=\"muted\" style=\"font-size:13px;\">Qty: ${it.quantity}</div>\n              </div>\n              <div>â‚¹${(it.price * it.quantity).toFixed(2)}</div>\n              <button class=\"icon-btn\" aria-label=\"Remove\" data-remove-index=\"${idx}\">Remove</button>\n            </div>\n          `;
        });
        cartItems.innerHTML = html;
        subtotal.textContent = `â‚¹${cart.total.toFixed(2)}`;
        const totalQty = cart.items.reduce((n, it) => n + it.quantity, 0);
        cartCount.textContent = String(totalQty);
        cartCountMobile.textContent = String(totalQty);
        [...cartItems.querySelectorAll('[data-remove-index]')].forEach(btn => {
          btn.addEventListener('click', (e) => {
            const idx = Number(e.currentTarget.getAttribute('data-remove-index'));
            cart.items.splice(idx, 1);
            renderCart();
          });
        });
      }

      // Enhanced cart functionality with animations
      function bindAddToCart() {
        document.querySelectorAll('[data-add-to-cart]').forEach((btn) => {
          btn.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            const card = btn.closest('.card');
            const title = card.querySelector('.title').textContent.trim();
            const variant = card.querySelector('.subtitle').textContent.trim();
            const priceText = card.querySelector('.price-row-card div').textContent.replace('â‚¹','').trim();
            const price = Number(priceText);
            addProductToCartData({ title, variant, price });
          });
        });
      }

      function renderProductSuggestions(currentProduct) {
        if (!productSuggestions) return;
        const pool = allProducts.filter(p => p.id !== currentProduct.id);
        const related = pool.filter(p => p.category === currentProduct.category);
        const suggestions = (related.length ? related : pool).slice(0, 3);
        productSuggestions.innerHTML = suggestions.map(p => `
          <article class="card suggestion-card" data-suggestion-id="${p.id}">
            <div class="media">
              <img src="${p.image}" alt="${p.title}" />
            </div>
            <div class="info">
              <div class="title">${p.title}</div>
              <div class="subtitle">${p.subtitle}</div>
              <div class="price-row-card" style="font-weight:700;">â‚¹${p.price}</div>
            </div>
          </article>
        `).join('');
        productSuggestions.querySelectorAll('[data-suggestion-id]').forEach(card => {
          card.addEventListener('click', () => {
            const id = card.getAttribute('data-suggestion-id');
            openProductModal(id);
          });
        });
      }

      function openProductModal(productId) {
        const product = allProducts.find(p => p.id === productId);
        if (!product || !productModalOverlay) return;
        activeProductId = productId;
        const detail = getProductDetailData(product);
        if (productModalImage) {
          productModalImage.src = product.image;
          productModalImage.alt = product.title;
        }
        if (productModalTitle) productModalTitle.textContent = product.title;
        if (productModalSubtitle) productModalSubtitle.textContent = product.subtitle;
        if (productModalPrice) productModalPrice.textContent = `â‚¹${product.price}`;
        if (productModalDelivery) productModalDelivery.textContent = detail.delivery;
        if (productModalOffers) {
          const offers = [...detail.offers, detail.coupon];
          productModalOffers.innerHTML = offers.map((offer, idx) => `<li>${offer}</li>`).join('');
        }
        if (productModalDescription) productModalDescription.textContent = detail.description;
        renderProductSuggestions(product);
        productModalOverlay.classList.add('active');
        productModalOverlay.setAttribute('aria-hidden', 'false');
        document.body.style.overflow = 'hidden';
        activeModal = 'product';
        showHeaderNavButtons();
      }

      function closeProductModal() {
        if (!productModalOverlay) return;
        productModalOverlay.classList.remove('active');
        productModalOverlay.setAttribute('aria-hidden', 'true');
        document.body.style.overflow = '';
        activeProductId = null;
        activeModal = null;
        hideHeaderNavButtons();
      }

      function bindProductCardClicks() {
        document.querySelectorAll('.card').forEach(card => {
          card.addEventListener('click', () => {
            const id = card.getAttribute('data-id');
            if (id) openProductModal(id);
          });
        });
      }

      productQueryForm?.addEventListener('submit', (e) => {
        e.preventDefault();
        const value = productQueryInput?.value.trim();
        if (!value) return;
        showToast('Thanks! Our team will get back to you shortly.');
        if (productQueryInput) productQueryInput.value = '';
      });

      modalAddToCartBtn?.addEventListener('click', () => {
        if (!activeProductId) return;
        const product = allProducts.find(p => p.id === activeProductId);
        if (!product) return;
        addProductToCartData({ title: product.title, variant: product.subtitle, price: product.price });
      });

      modalBuyNowBtn?.addEventListener('click', () => {
        const currentUser = getCurrentUser();
        closeProductModal();
        
        if (!currentUser) {
          // User not logged in - show login modal
          // Set a flag to open address selection after login
          localStorage.setItem('pendingCheckout', 'true');
          setTimeout(() => openLoginModal(), 300);
            } else {
          // User already logged in - show address selection interface
          setTimeout(() => openAddressSelectionModal(), 300);
        }
      });

      // Mobile search modal
      const mobileSearchModal = document.getElementById('mobileSearchModal');
      const mobileSearchInput = document.getElementById('mobileSearchInput');
      const mobileSearchResults = document.getElementById('mobileSearchResults');
      const mobileClearSearch = document.getElementById('mobileClearSearch');
      const closeMobileSearch = document.getElementById('closeMobileSearch');
      let mobileSearchTimeout;

      function openMobileSearch() {
        mobileSearchModal?.classList.add('active');
        mobileSearchModal?.setAttribute('aria-hidden', 'false');
        document.body.style.overflow = 'hidden';
        setTimeout(() => mobileSearchInput?.focus(), 100);
      }

      function closeMobileSearchModal() {
        mobileSearchModal?.classList.remove('active');
        mobileSearchModal?.setAttribute('aria-hidden', 'true');
        document.body.style.overflow = '';
        if (mobileSearchInput) mobileSearchInput.value = '';
        if (mobileSearchResults) mobileSearchResults.innerHTML = '';
        if (mobileClearSearch) mobileClearSearch.style.display = 'none';
        filterGrid(''); // Reset product grid
      }

      function renderMobileSearchResults(query) {
        if (!mobileSearchResults) return;
        const products = getAllProducts();
        const q = query.toLowerCase();
        const matches = products.filter(p => 
          p.title.toLowerCase().includes(q) || 
          p.subtitle.toLowerCase().includes(q)
        );
        
        if (q.length === 0) {
          mobileSearchResults.innerHTML = '<div class="muted" style="padding:20px; text-align:center;">Start typing to search...</div>';
          return;
        }
        
        if (matches.length === 0) {
          mobileSearchResults.innerHTML = '<div class="muted" style="padding:20px; text-align:center;">No results found</div>';
          return;
        }
        
        mobileSearchResults.innerHTML = matches.map(p => `
          <div class="search-item" data-target-title="${p.title}" style="margin-bottom:12px;">
            <img class="search-thumb" src="${p.img}" alt="${p.title}" />
            <div style="flex:1;">
              <div class="search-title">${p.title}</div>
              <div class="search-sub">${p.subtitle}</div>
            </div>
            <div class="search-price">â‚¹${p.price}</div>
          </div>
        `).join('');
        
        // Add click handlers
        mobileSearchResults.querySelectorAll('.search-item').forEach(item => {
          item.addEventListener('click', () => {
            const title = item.getAttribute('data-target-title');
            const target = Array.from(document.querySelectorAll('.card')).find(c => 
              c.querySelector('.title').textContent.trim() === title
            );
            if (target) {
              closeMobileSearchModal();
              setTimeout(() => {
                document.querySelectorAll('.card').forEach(c => c.classList.remove('highlight'));
                target.scrollIntoView({ behavior: 'smooth', block: 'center' });
                target.classList.add('highlight');
                setTimeout(() => target.classList.remove('highlight'), 2000);
              }, 300);
            }
          });
        });
      }

      // Mobile search input handler
      mobileSearchInput?.addEventListener('input', (e) => {
        clearTimeout(mobileSearchTimeout);
        const value = e.target.value.trim();
        
        if (value.length > 0) {
          if (mobileClearSearch) mobileClearSearch.style.display = 'block';
          mobileSearchTimeout = setTimeout(() => {
            renderMobileSearchResults(value);
            filterGrid(value);
          }, 300);
            } else {
          if (mobileClearSearch) mobileClearSearch.style.display = 'none';
          renderMobileSearchResults('');
          filterGrid('');
        }
      });

      mobileClearSearch?.addEventListener('click', () => {
        if (mobileSearchInput) mobileSearchInput.value = '';
        if (mobileClearSearch) mobileClearSearch.style.display = 'none';
        renderMobileSearchResults('');
        filterGrid('');
        mobileSearchInput?.focus();
      });

      closeMobileSearch?.addEventListener('click', closeMobileSearchModal);

      // Close on escape key
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          if (mobileSearchModal?.classList.contains('active')) {
            closeMobileSearchModal();
          }
          if (productModalOverlay?.classList.contains('active')) {
            closeProductModal();
          }
        }
      });

      // Universal back button handler - closes whichever modal is active
      headerBackBtn?.addEventListener('click', () => {
        switch(activeModal) {
          case 'product':
            closeProductModal();
            break;
          case 'cart':
            closeCartModal();
            break;
          case 'favorites':
            closeFavoritesModal();
            break;
          case 'login':
            closeLoginModalFunc();
            break;
          case 'profile':
            closeUserProfileModalFunc();
            break;
          case 'checkout':
            closeCheckoutModalFunc();
            break;
          default:
            // If no specific modal, try to close any open modal
            if (productModalOverlay?.classList.contains('active')) closeProductModal();
            else if (cartModalOverlay?.classList.contains('active')) closeCartModal();
            else if (favoritesModalOverlay?.classList.contains('active')) closeFavoritesModal();
            else if (loginModalOverlay?.classList.contains('active')) closeLoginModalFunc();
            else if (userProfileModalOverlay?.classList.contains('active')) closeUserProfileModalFunc();
            else if (checkoutModalOverlay?.classList.contains('active')) closeCheckoutModalFunc();
        }
      });
      productModalOverlay?.addEventListener('click', (e) => {
        if (e.target === productModalOverlay) closeProductModal();
      });

      // Header search icon functionality
      const headerSearchIcon = document.getElementById('headerSearchIcon');
      headerSearchIcon?.addEventListener('click', () => {
        // Focus the search input if search form is visible (desktop)
        if (searchForm && window.innerWidth > 640) {
          const searchInput = searchForm.querySelector('input');
          searchInput?.focus();
        } else {
          // On mobile, open search modal
          openMobileSearch();
        }
      });

      // Enhanced search with live results
      const searchInput = searchForm?.querySelector('input');
      let searchTimeout;
      
      function getAllProducts() {
        return Array.from(document.querySelectorAll('.card')).map(card => ({
          card,
          title: card.querySelector('.title').textContent.trim(),
          subtitle: card.querySelector('.subtitle').textContent.trim(),
          price: card.querySelector('.price-row-card div').textContent.trim(),
          img: card.querySelector('.media img')?.getAttribute('src') || '',
        }));
      }

      function filterGrid(query) {
        const q = query.trim().toLowerCase();
        const cards = document.querySelectorAll('.card');
        if (q.length === 0) {
          cards.forEach(card => { card.style.display = 'flex'; card.style.opacity = '1'; card.style.transform = 'translateY(0)'; });
          return;
        }
        cards.forEach(card => {
          const title = card.querySelector('.title').textContent.toLowerCase();
          const subtitle = card.querySelector('.subtitle').textContent.toLowerCase();
          const matches = title.includes(q) || subtitle.includes(q);
          card.style.display = matches ? 'flex' : 'none';
          card.style.opacity = matches ? '1' : '0';
          card.style.transform = matches ? 'translateY(0)' : 'translateY(20px)';
        });
      }

      function renderSuggestions(query) {
        const products = getAllProducts();
        const q = query.toLowerCase();
        const matches = products.filter(p => p.title.toLowerCase().includes(q) || p.subtitle.toLowerCase().includes(q));
        if (matches.length === 0) {
          searchList.innerHTML = '<div class="muted" style="padding:10px;">No results</div>';
          return;
        }
        searchList.innerHTML = matches.map(p => `
          <div class="search-item" data-target-title="${p.title}">
            <img class="search-thumb" src="${p.img}" alt="${p.title}" />
            <div>
              <div class="search-title">${p.title}</div>
              <div class="search-sub">${p.subtitle}</div>
            </div>
            <div class="search-price">â‚¹${p.price}</div>
          </div>
        `).join('');
        searchList.querySelectorAll('.search-item').forEach(item => {
          item.addEventListener('click', () => {
            const title = item.getAttribute('data-target-title');
            const target = Array.from(document.querySelectorAll('.card')).find(c => c.querySelector('.title').textContent.trim() === title);
            if (target) {
              document.querySelectorAll('.card').forEach(c => c.classList.remove('highlight'));
              target.scrollIntoView({ behavior: 'smooth', block: 'center' });
              target.classList.add('highlight');
              setTimeout(() => target.classList.remove('highlight'), 2000);
            }
            searchForm.classList.remove('open');
          });
        });
      }

      searchInput?.addEventListener('input', (e) => {
        clearTimeout(searchTimeout);
        const value = e.target.value.trim();
        
        if (value.length > 0) {
          searchTimeout = setTimeout(() => {
            // Live suggestions + filter grid
            renderSuggestions(value);
            filterGrid(value);
            searchForm.classList.add('open');
          }, 300);
        } else if (value.length === 0) {
          // Show all cards
          filterGrid('');
          searchForm.classList.remove('open');
        }
      });

      clearSearch?.addEventListener('click', () => {
        filterGrid('');
        searchInput.value = '';
        searchForm.classList.remove('open');
        searchInput.focus();
      });

      // Submit search to filter grid
      searchForm?.addEventListener('submit', (e) => {
        e.preventDefault();
        const value = searchInput.value.trim();
        filterGrid(value);
        searchForm.classList.remove('open');
      });

      // Apply current filter when focusing the search bar
      searchInput?.addEventListener('focus', () => {
        const value = searchInput.value.trim();
        if (value.length > 0) {
          filterGrid(value);
          renderSuggestions(value);
          searchForm.classList.add('open');
        }
      });

      // Enhanced newsletter with success animation
      newsletterForm?.addEventListener('submit', (e) => {
        e.preventDefault();
        const email = newsletterForm.querySelector('input').value.trim();
        const button = newsletterForm.querySelector('button');
        
        if (email) {
          button.textContent = 'Subscribing...';
          button.disabled = true;
          
          setTimeout(() => {
            button.textContent = 'Subscribed!';
            button.style.background = 'var(--success)';
            
            setTimeout(() => {
              button.textContent = 'Subscribe';
              button.disabled = false;
              button.style.background = 'var(--brand)';
              newsletterForm.querySelector('input').value = '';
            }, 2000);
          }, 1000);
        }
      });

      // Filter functionality
      const filterCheckboxes = document.querySelectorAll('.filters input[type="checkbox"]');
      
      filterCheckboxes.forEach(checkbox => {
        checkbox.addEventListener('change', applyFilters);
      });
      
      function applyFilters() {
        const cards = document.querySelectorAll('.card');
        const selectedCategories = Array.from(filterCheckboxes)
          .filter(cb => cb.checked)
          .map(cb => cb.value);
        
        cards.forEach((card, index) => {
          const category = card.getAttribute('data-category') || '';
          const matchesCategory = selectedCategories.length === 0 || selectedCategories.includes(category);
          if (matchesCategory) {
            card.style.display = 'flex';
            card.style.animation = `slideInUp 0.6s ease-out ${index * 0.1}s both`;
          } else {
            card.style.display = 'none';
          }
        });
      }

      // Apply filters on button click (optional explicit action)
      document.getElementById('applyFiltersBtn')?.addEventListener('click', applyFilters);

      // Filter toggle functionality for mobile
      const filterToggleBtn = document.getElementById('filterToggleBtn');
      const closeFiltersBtn = document.getElementById('closeFiltersBtn');
      const filtersOverlay = document.getElementById('filtersOverlay');
      const filters = document.querySelector('.filters');

      function openFilters() {
        filters?.classList.add('open');
        filtersOverlay?.classList.add('active');
        document.body.style.overflow = 'hidden';
      }

      function closeFilters() {
        filters?.classList.remove('open');
        filtersOverlay?.classList.remove('active');
        document.body.style.overflow = '';
      }

      filterToggleBtn?.addEventListener('click', openFilters);
      closeFiltersBtn?.addEventListener('click', closeFilters);
      filtersOverlay?.addEventListener('click', closeFilters);

      // Close filters on escape key
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && filters?.classList.contains('open')) {
          closeFilters();
        }
      });

      // Sort functionality
      const sortSelect = document.getElementById('sort');
      sortSelect?.addEventListener('change', (e) => {
        const cards = Array.from(document.querySelectorAll('.card'));
        const container = document.querySelector('.grid');
        
        const sortBy = e.target.value;
        cards.sort((a, b) => {
          const titleA = a.querySelector('.title').textContent;
          const titleB = b.querySelector('.title').textContent;
          const priceA = parseFloat(a.querySelector('.price-row-card div').textContent.replace('â‚¹',''));
          const priceB = parseFloat(b.querySelector('.price-row-card div').textContent.replace('â‚¹',''));
          
          switch(sortBy) {
            case 'Price: Low to High':
              return priceA - priceB;
            case 'Price: High to Low':
              return priceB - priceA;
            case 'Newest':
              return Math.random() - 0.5;
            default:
              return 0;
          }
        });
        
        // Animate reordering
        cards.forEach((card, index) => {
          card.style.animation = `slideInUp 0.6s ease-out ${index * 0.1}s both`;
          container.appendChild(card);
        });
      });

      // Intersection Observer for scroll animations
      const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
      };
      
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.style.animationPlayState = 'running';
          }
        });
      }, observerOptions);
      
      // Observe cards for scroll animations
      document.querySelectorAll('.card').forEach(card => {
        observer.observe(card);
      });

      // Parallax effect for hero section
      window.addEventListener('scroll', () => {
        const scrolled = window.pageYOffset;
        const heroMedia = document.querySelector('.hero-media');
        if (heroMedia) {
          heroMedia.style.transform = `translateY(${scrolled * 0.3}px)`;
        }
      });


      // Keyboard navigation
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          closeCartModal();
        }
      });

      // Mobile tab actions
      document.getElementById('tabHome')?.addEventListener('click', () => window.scrollTo({ top: 0, behavior: 'smooth' }));
      document.getElementById('tabSearch')?.addEventListener('click', () => {
        if (window.innerWidth <= 640) {
          openMobileSearch();
        } else {
          searchInput?.focus();
        }
      });
      document.getElementById('tabProducts')?.addEventListener('click', () => document.getElementById('products')?.scrollIntoView({ behavior: 'smooth' }));
      document.getElementById('tabCart')?.addEventListener('click', () => openCartModal());
      
      // Mobile tab bar profile button
      document.getElementById('tabProfile')?.addEventListener('click', () => {
        const currentUser = getCurrentUser();
        if (currentUser) {
          openUserProfile();
        } else {
          openLoginModal();
        }
      });

      // Load products.json and build UI
      function renderProductCards(list) {
        if (!productsGrid) return;
        const favorites = getFavorites();
        const html = list.map(p => {
          const isFavorite = favorites.includes(p.id);
          return `
          <article class="card" data-category="${p.category}" data-id="${p.id}">
            <div class="media">
              <img src="${p.image}" alt="${p.title}" />
              <button class="favorite-btn ${isFavorite ? 'active' : ''}" data-product-id="${p.id}" aria-label="Add to favorites" onclick="event.stopPropagation(); toggleFavorite('${p.id}')">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </button>
            </div>
            <div class="info">
              <div class="title">${p.title}</div>
              <div class="subtitle">${p.subtitle}</div>
              <div class="price-row-card"><div>â‚¹${p.price}</div></div>
            </div>
          </article>
        `;
        }).join('');
        productsGrid.innerHTML = html;
        if (productCountEl) productCountEl.textContent = String(list.length);
        bindProductCardClicks();
        updateFavoritesCount();
      }

      async function loadProducts() {
        try {
          const res = await fetch('products.json', { cache: 'no-store' });
          allProducts = await res.json();
          renderProductCards(allProducts);
          const uniq = Array.from(new Set(allProducts.map(p => p.category)));
          categoriesFromData = uniq.map(c => ({ key: c, label: c.replace(/-/g, ' ').replace(/\b\w/g, m => m.toUpperCase()) }));
          renderAds(adsBottom);
        } catch (e) {
          console.error('Failed to load products.json', e);
        }
      }

      loadProducts();
      updateFavoritesCount();

      // Phone view modal
      function setPhoneOpen(isOpen) {
        phoneOverlay.setAttribute('aria-hidden', String(!isOpen));
        if (isOpen) {
          // Load current page into iframe
          phoneIframe.src = window.location.href;
        } else {
          phoneIframe.src = '';
        }
      }
      openPhoneView?.addEventListener('click', () => {
        setPhoneOpen(true);
        setMoreMenuOpen(false);
      });
      closePhoneView?.addEventListener('click', () => setPhoneOpen(false));
      phoneOverlay?.addEventListener('click', (e) => {
        if (e.target === phoneOverlay) setPhoneOpen(false);
      });
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') setPhoneOpen(false);
      });

      // Chatbot functionality
      const chatbotOverlay = document.getElementById('chatbotOverlay');
      const helpBtn = document.getElementById('helpBtn');
      const closeChatbot = document.getElementById('closeChatbot');
      const chatbotInput = document.getElementById('chatbotInput');
      const chatbotSend = document.getElementById('chatbotSend');
      const chatbotMessages = document.getElementById('chatbotMessages');

      function openChatbot() {
        if (chatbotOverlay) {
          chatbotOverlay.setAttribute('aria-hidden', 'false');
          document.body.style.overflow = 'hidden';
          if (chatbotInput) chatbotInput.focus();
        }
      }

      function closeChatbotModal() {
        if (chatbotOverlay) {
          chatbotOverlay.setAttribute('aria-hidden', 'true');
          document.body.style.overflow = '';
        }
      }

      // Knowledge base for resin products
      const chatbotKnowledge = {
        products: {
          keywords: ['product', 'items', 'what do you sell', 'catalog', 'collection'],
          response: 'We specialize in handcrafted resin products including resin art pieces, floral keepsakes, custom resin jewelry, resin home decor items, and personalized resin gifts. All our products are made with high-quality resin and can be customized to your preferences.'
        },
        materials: {
          keywords: ['material', 'resin', 'what is resin', 'quality', 'durable', 'safe'],
          response: 'We use premium epoxy resin that is food-safe, non-toxic, and UV-resistant. Our resin products are durable, waterproof, and designed to last for years. The resin we use is crystal clear and maintains its clarity over time. All materials are sourced from trusted suppliers and meet safety standards.'
        },
        customization: {
          keywords: ['custom', 'personalize', 'personalization', 'bespoke', 'customize', 'special order'],
          response: 'Yes! We offer full customization services. You can customize colors, add personal photos, include special messages, choose specific flowers or materials, and request unique designs. Custom orders typically take 7-14 business days. You can book a custom order through our website or contact us directly for bulk and corporate gifts.'
        },
        shipping: {
          keywords: ['shipping', 'delivery', 'how long', 'when will i receive', 'delivery time', 'shipping time'],
          response: 'We offer free shipping on orders over â‚¹500. Standard delivery takes 5-7 business days within India. Express shipping (2-3 business days) is available for an additional charge. We carefully package all items to ensure they arrive safely. You\'ll receive a tracking number once your order ships.'
        },
        care: {
          keywords: ['care', 'maintain', 'clean', 'how to clean', 'maintenance', 'preserve'],
          response: 'Resin products are easy to care for! Simply wipe with a soft, damp cloth. Avoid using harsh chemicals or abrasive cleaners. Keep away from direct sunlight for extended periods to prevent yellowing. Store in a cool, dry place. Our resin items are waterproof, so they can be cleaned with mild soap and water if needed.'
        },
        pricing: {
          keywords: ['price', 'cost', 'how much', 'expensive', 'affordable', 'pricing'],
          response: 'Our products range from â‚¹299 to â‚¹5,999 depending on size, complexity, and customization. We offer competitive pricing for high-quality handcrafted items. Special discounts are available for bulk orders and corporate gifts. Check our website for current promotions and coupon codes.'
        },
        returns: {
          keywords: ['return', 'refund', 'exchange', 'cancel', 'return policy', 'money back'],
          response: 'We offer a 30-day return policy. Items must be in original condition and packaging. Customized items are non-refundable unless there\'s a defect. For returns, contact us within 7 days of delivery. We\'ll process refunds within 5-7 business days after receiving the returned item.'
        },
        payment: {
          keywords: ['payment', 'pay', 'how to pay', 'payment method', 'credit card', 'cash on delivery'],
          response: 'We accept all major credit/debit cards, UPI, net banking, and cash on delivery (COD) for orders above â‚¹500. All payments are processed securely through encrypted gateways. You\'ll receive a payment confirmation email once your order is placed.'
        },
        flowers: {
          keywords: ['flower', 'floral', 'preserved', 'dried flowers', 'flowers in resin'],
          response: 'We use high-quality preserved and dried flowers in our resin products. These flowers are specially treated to maintain their color and beauty for years. We source flowers from local suppliers and ensure they are properly preserved before embedding them in resin. You can choose specific flowers for custom orders.'
        },
        greeting: {
          keywords: ['hello', 'hi', 'hey', 'help', 'support'],
          response: 'Hello! I\'m here to help you with questions about our resin products, orders, shipping, customization, and more. Feel free to ask me anything!'
        }
      };

      function getChatbotResponse(userMessage) {
        const message = userMessage.toLowerCase();
        
        // Check each knowledge category
        for (const [category, data] of Object.entries(chatbotKnowledge)) {
          if (data.keywords.some(keyword => message.includes(keyword))) {
            return data.response;
          }
        }
        
        // Default response if no match
        return 'I understand you\'re asking about: "' + userMessage + '". For specific questions about our resin products, customization, shipping, or orders, please provide more details. You can also contact our support team directly for personalized assistance.';
      }

      function addMessage(text, isUser = false) {
        if (!chatbotMessages) return;
        const messageDiv = document.createElement('div');
        messageDiv.className = `chatbot-message ${isUser ? 'user' : 'bot'}`;
        messageDiv.innerHTML = `
          <div class="message-content">
            <p>${text}</p>
          </div>
        `;
        chatbotMessages.appendChild(messageDiv);
        chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
      }

      function sendMessage() {
        if (!chatbotInput || !chatbotInput.value.trim()) return;
        
        const userMessage = chatbotInput.value.trim();
        addMessage(userMessage, true);
        chatbotInput.value = '';
        
        // Disable send button while processing
        if (chatbotSend) chatbotSend.disabled = true;
        
        // Simulate thinking delay
        setTimeout(() => {
          const botResponse = getChatbotResponse(userMessage);
          addMessage(botResponse, false);
          if (chatbotSend) chatbotSend.disabled = false;
          if (chatbotInput) chatbotInput.focus();
        }, 500);
      }

      helpBtn?.addEventListener('click', openChatbot);
      closeChatbot?.addEventListener('click', closeChatbotModal);
      chatbotOverlay?.addEventListener('click', (e) => {
        if (e.target === chatbotOverlay) closeChatbotModal();
      });
      chatbotSend?.addEventListener('click', sendMessage);
      chatbotInput?.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') sendMessage();
      });
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && chatbotOverlay?.getAttribute('aria-hidden') === 'false') {
          closeChatbotModal();
        }
      });

      // Inject Product JSON-LD for SEO
      function injectProductJsonLd(products) {
        try {
          const ld = {
            '@context': 'https://schema.org',
            '@type': 'ItemList',
            itemListElement: products.map((p, i) => ({
              '@type': 'ListItem',
              position: i + 1,
              item: {
                '@type': 'Product',
                name: p.title,
                description: p.subtitle,
                image: p.image,
                category: p.category,
                offers: {
                  '@type': 'Offer',
                  price: String(p.price),
                  priceCurrency: 'USD',
                  availability: 'https://schema.org/InStock'
                }
              }
            }))
          };
          const script = document.createElement('script');
          script.type = 'application/ld+json';
          script.textContent = JSON.stringify(ld);
          document.head.appendChild(script);
        } catch {}
      }

      // After products load, also inject JSON-LD and render cart
      (async () => {
        await loadProducts();
        injectProductJsonLd(allProducts);
        renderCart();
        updateFavoritesCount();
      })();
    </script>
  </body>
  </html>


